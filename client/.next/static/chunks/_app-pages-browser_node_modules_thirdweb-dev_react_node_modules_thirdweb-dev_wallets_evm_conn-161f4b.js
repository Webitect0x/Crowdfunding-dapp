"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_node_modules_thirdweb-dev_react_node_modules_thirdweb-dev_wallets_evm_conn-161f4b"],{

/***/ "(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/embedded-wallet-30be9c09.browser.esm.js":
/*!**************************************************************************************************************************!*\
  !*** ./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/embedded-wallet-30be9c09.browser.esm.js ***!
  \**************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   A: function() { return /* binding */ AUTH_TOKEN_LOCAL_STORAGE_NAME; },\n/* harmony export */   D: function() { return /* binding */ DEVICE_SHARE_LOCAL_STORAGE_NAME; },\n/* harmony export */   E: function() { return /* binding */ EmbeddedWalletSdk; },\n/* harmony export */   R: function() { return /* binding */ RecoveryShareManagement; },\n/* harmony export */   U: function() { return /* binding */ UserWalletStatus; },\n/* harmony export */   W: function() { return /* binding */ WALLET_USER_DETAILS_LOCAL_STORAGE_NAME; },\n/* harmony export */   a: function() { return /* binding */ DEVICE_SHARE_LOCAL_STORAGE_NAME_DEPRECATED; },\n/* harmony export */   b: function() { return /* binding */ WALLET_USER_ID_LOCAL_STORAGE_NAME; },\n/* harmony export */   c: function() { return /* binding */ AuthProvider; }\n/* harmony export */ });\n/* harmony import */ var _paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @paperxyz/sdk-common-utilities */ \"(app-pages-browser)/./node_modules/@paperxyz/sdk-common-utilities/dist/index.mjs\");\n/* harmony import */ var _defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./defineProperty-c8ecdc07.browser.esm.js */ \"(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/defineProperty-c8ecdc07.browser.esm.js\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ethers */ \"(app-pages-browser)/./node_modules/@ethersproject/abstract-signer/lib.esm/index.js\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ethers */ \"(app-pages-browser)/./node_modules/@ethersproject/providers/lib.esm/index.js\");\n/* harmony import */ var ethers_lib_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ethers/lib/utils */ \"(app-pages-browser)/./node_modules/ethers/lib/utils.js\");\n/* harmony import */ var ethers_lib_utils__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(ethers_lib_utils__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\n\nconst EMBEDDED_WALLET_PATH = \"/sdk/2022-08-12/embedded-wallet\";\nconst GET_IFRAME_BASE_URL = () => `${(0,_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.getPaperOriginUrl)().replace(\"withpaper.com\", \"embedded-wallet.thirdweb.com\")}`;\nconst WALLET_USER_DETAILS_LOCAL_STORAGE_NAME = clientId => `thirdwebEwsWalletUserDetails-${clientId}`;\nconst WALLET_USER_ID_LOCAL_STORAGE_NAME = clientId => `thirdwebEwsWalletUserId-${clientId}`;\nconst AUTH_TOKEN_LOCAL_STORAGE_PREFIX = \"walletToken\";\nconst AUTH_TOKEN_LOCAL_STORAGE_NAME = clientId => {\n  return `${AUTH_TOKEN_LOCAL_STORAGE_PREFIX}-${clientId}`;\n};\nconst DEVICE_SHARE_LOCAL_STORAGE_PREFIX = \"a\";\nconst DEVICE_SHARE_LOCAL_STORAGE_NAME = (clientId, userId) => `${DEVICE_SHARE_LOCAL_STORAGE_PREFIX}-${clientId}-${userId}`;\nconst DEVICE_SHARE_LOCAL_STORAGE_NAME_DEPRECATED = clientId => `${DEVICE_SHARE_LOCAL_STORAGE_PREFIX}-${clientId}`;\n\nlet RecoveryShareManagement = /*#__PURE__*/function (RecoveryShareManagement) {\n  RecoveryShareManagement[\"USER_MANAGED\"] = \"USER_MANAGED\";\n  RecoveryShareManagement[\"CLOUD_MANAGED\"] = \"AWS_MANAGED\";\n  return RecoveryShareManagement;\n}({});\nlet AuthProvider = /*#__PURE__*/function (AuthProvider) {\n  AuthProvider[\"COGNITO\"] = \"Cognito\";\n  AuthProvider[\"GOOGLE\"] = \"Google\";\n  AuthProvider[\"EMAIL_OTP\"] = \"EmailOtp\";\n  AuthProvider[\"CUSTOM_JWT\"] = \"CustomJWT\";\n  AuthProvider[\"FACEBOOK\"] = \"Facebook\";\n  AuthProvider[\"APPLE\"] = \"Apple\";\n  return AuthProvider;\n}({});\n\n// TODO: Clean up tech debt of random type Objects\n// E.g. StoredTokenType is really not used anywhere but it exists as this object for legacy reason\n\n// Class constructor types\n// types for class constructors still a little messy right now.\n// Open to PRs from whoever sees this and knows of a cleaner way to handle things\n// Auth Types\n// Embedded Wallet Types\nlet UserWalletStatus = /*#__PURE__*/function (UserWalletStatus) {\n  UserWalletStatus[\"LOGGED_OUT\"] = \"Logged Out\";\n  UserWalletStatus[\"LOGGED_IN_WALLET_UNINITIALIZED\"] = \"Logged In, Wallet Uninitialized\";\n  UserWalletStatus[\"LOGGED_IN_NEW_DEVICE\"] = \"Logged In, New Device\";\n  UserWalletStatus[\"LOGGED_IN_WALLET_INITIALIZED\"] = \"Logged In, Wallet Initialized\";\n  return UserWalletStatus;\n}({});\n\n// ! Types seem repetitive, but the name should identify which goes where\n// this is the return type from the EmbeddedWallet Class getUserWalletStatus method iframe call\n// this is the return type from the EmbeddedWallet Class getUserWalletStatus method\n\nconst data = new Map();\nclass LocalStorage {\n  constructor(_ref) {\n    let {\n      clientId\n    } = _ref;\n    this.isSupported = !!window.localStorage;\n    this.clientId = clientId;\n  }\n  async getItem(key) {\n    if (this.isSupported) {\n      return window.localStorage.getItem(key);\n    } else {\n      return data.get(key) ?? null;\n    }\n  }\n  async setItem(key, value) {\n    if (this.isSupported) {\n      return window.localStorage.setItem(key, value);\n    } else {\n      data.set(key, value);\n    }\n  }\n  async removeItem(key) {\n    const item = await this.getItem(key);\n    if (this.isSupported && item) {\n      window.localStorage.removeItem(key);\n      return true;\n    }\n    return false;\n  }\n  async saveAuthCookie(cookie) {\n    await this.setItem(AUTH_TOKEN_LOCAL_STORAGE_NAME(this.clientId), cookie);\n  }\n  async getAuthCookie() {\n    return this.getItem(AUTH_TOKEN_LOCAL_STORAGE_NAME(this.clientId));\n  }\n  async removeAuthCookie() {\n    return this.removeItem(AUTH_TOKEN_LOCAL_STORAGE_NAME(this.clientId));\n  }\n  async saveDeviceShare(share, userId) {\n    await this.saveWalletUserId(userId);\n    await this.setItem(DEVICE_SHARE_LOCAL_STORAGE_NAME(this.clientId, userId), share);\n  }\n  async getDeviceShare() {\n    const userId = await this.getWalletUserId();\n    if (userId) {\n      return this.getItem(DEVICE_SHARE_LOCAL_STORAGE_NAME(this.clientId, userId));\n    }\n    return null;\n  }\n  async removeDeviceShare() {\n    const userId = await this.getWalletUserId();\n    if (userId) {\n      return this.removeItem(DEVICE_SHARE_LOCAL_STORAGE_NAME(this.clientId, userId));\n    }\n    return false;\n  }\n  async getWalletUserId() {\n    return this.getItem(WALLET_USER_ID_LOCAL_STORAGE_NAME(this.clientId));\n  }\n  async saveWalletUserId(userId) {\n    await this.setItem(WALLET_USER_ID_LOCAL_STORAGE_NAME(this.clientId), userId);\n  }\n  async removeWalletUserId() {\n    return this.removeItem(WALLET_USER_ID_LOCAL_STORAGE_NAME(this.clientId));\n  }\n}\n\nfunction sleep(seconds) {\n  return new Promise(resolve => {\n    setTimeout(resolve, seconds * 1000);\n  });\n}\nconst iframeBaseStyle = {\n  height: \"100%\",\n  width: \"100%\",\n  border: \"none\",\n  backgroundColor: \"transparent\",\n  colorScheme: \"light\",\n  position: \"fixed\",\n  top: \"0px\",\n  right: \"0px\",\n  zIndex: \"2147483646\",\n  display: \"none\"\n};\n\n// Global var to help track iframe state\nconst isIframeLoaded = new Map();\nclass IframeCommunicator {\n  constructor(_ref) {\n    let {\n      link,\n      iframeId,\n      container = document.body,\n      iframeStyles,\n      onIframeInitialize\n    } = _ref;\n    (0,_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__._)(this, \"POLLING_INTERVAL_SECONDS\", 1.4);\n    this.iframeBaseUrl = GET_IFRAME_BASE_URL();\n\n    // Creating the IFrame element for communication\n    let iframe = document.getElementById(iframeId);\n    const hrefLink = new URL(link);\n    const sdkVersion = \"2.1.9\";\n    hrefLink.searchParams.set(\"sdkVersion\", sdkVersion);\n    if (!iframe || iframe.src !== hrefLink.href) {\n      // ! Do not update the hrefLink here or it'll cause multiple re-renders\n      if (!iframe) {\n        iframe = document.createElement(\"iframe\");\n        const mergedIframeStyles = {\n          ...iframeBaseStyle,\n          ...iframeStyles\n        };\n        Object.assign(iframe.style, mergedIframeStyles);\n        iframe.setAttribute(\"id\", iframeId);\n        iframe.setAttribute(\"fetchpriority\", \"high\");\n        container.appendChild(iframe);\n      }\n      iframe.src = hrefLink.href;\n      iframe.setAttribute(\"data-version\", sdkVersion);\n      const onIframeLoaded = event => {\n        if (event.data.eventType === \"ewsIframeLoaded\") {\n          window.removeEventListener(\"message\", onIframeLoaded);\n          if (!iframe) {\n            console.warn(\"thirdweb Iframe not found\");\n            return;\n          }\n          this.onIframeLoadHandler(iframe, onIframeInitialize)();\n        }\n      };\n      window.addEventListener(\"message\", onIframeLoaded);\n    }\n    this.iframe = iframe;\n  }\n  async onIframeLoadedInitVariables() {\n    return {};\n  }\n  onIframeLoadHandler(iframe, onIframeInitialize) {\n    return async () => {\n      const promise = new Promise(async (res, rej) => {\n        const channel = new MessageChannel();\n        channel.port1.onmessage = event => {\n          const {\n            data\n          } = event;\n          channel.port1.close();\n          if (!data.success) {\n            return rej(new Error(data.error));\n          }\n          isIframeLoaded.set(iframe.src, true);\n          if (onIframeInitialize) {\n            onIframeInitialize();\n          }\n          return res(true);\n        };\n        const INIT_IFRAME_EVENT = \"initIframe\";\n        iframe?.contentWindow?.postMessage(\n        // ? We initialise the iframe with a bunch\n        // of useful information so that we don't have to pass it\n        // through in each of the future call. This would be where we do it.\n        {\n          eventType: INIT_IFRAME_EVENT,\n          data: await this.onIframeLoadedInitVariables()\n        }, this.iframeBaseUrl, [channel.port2]);\n      });\n      await promise;\n    };\n  }\n  async call(_ref2) {\n    let {\n      procedureName,\n      params,\n      showIframe = false\n    } = _ref2;\n    while (!isIframeLoaded.get(this.iframe.src)) {\n      await sleep(this.POLLING_INTERVAL_SECONDS);\n    }\n    if (showIframe) {\n      this.iframe.style.display = \"block\";\n      // magic number to let the display render before performing the animation of the modal in\n      await sleep(0.005);\n    }\n    const promise = new Promise((res, rej) => {\n      const channel = new MessageChannel();\n      channel.port1.onmessage = async event => {\n        const {\n          data\n        } = event;\n        channel.port1.close();\n        if (showIframe) {\n          // magic number to let modal fade out before hiding it\n          await sleep(0.1);\n          this.iframe.style.display = \"none\";\n        }\n        if (!data.success) {\n          rej(new Error(data.error));\n        } else {\n          res(data.data);\n        }\n      };\n      this.iframe.contentWindow?.postMessage({\n        eventType: procedureName,\n        data: params\n      }, this.iframeBaseUrl, [channel.port2]);\n    });\n    return promise;\n  }\n\n  /**\n   * This has to be called by any iframe that will be removed from the DOM.\n   * Use to make sure that we reset the global loaded state of the particular iframe.src\n   */\n  destroy() {\n    isIframeLoaded.delete(this.iframe.src);\n  }\n}\n\nclass EmbeddedWalletIframeCommunicator extends IframeCommunicator {\n  constructor(_ref) {\n    let {\n      clientId,\n      customizationOptions\n    } = _ref;\n    super({\n      iframeId: EMBEDDED_WALLET_IFRAME_ID,\n      link: createEmbeddedWalletIframeLink({\n        clientId,\n        path: EMBEDDED_WALLET_PATH,\n        queryParams: customizationOptions\n      }).href,\n      container: document.body\n    });\n    this.clientId = clientId;\n  }\n  async onIframeLoadedInitVariables() {\n    const localStorage = new LocalStorage({\n      clientId: this.clientId\n    });\n    return {\n      authCookie: await localStorage.getAuthCookie(),\n      deviceShareStored: await localStorage.getDeviceShare(),\n      walletUserId: await localStorage.getWalletUserId(),\n      clientId: this.clientId\n    };\n  }\n}\n\n// This is the URL and ID tag of the iFrame that we communicate with\nfunction createEmbeddedWalletIframeLink(_ref2) {\n  let {\n    clientId,\n    path,\n    queryParams\n  } = _ref2;\n  const embeddedWalletUrl = new URL(`${path}`, GET_IFRAME_BASE_URL());\n  if (queryParams) {\n    for (const queryKey of Object.keys(queryParams)) {\n      embeddedWalletUrl.searchParams.set(queryKey, queryParams[queryKey]?.toString() || \"\");\n    }\n  }\n  embeddedWalletUrl.searchParams.set(\"clientId\", clientId);\n  return embeddedWalletUrl;\n}\nconst EMBEDDED_WALLET_IFRAME_ID = \"thirdweb-embedded-wallet-iframe\";\n\nclass AbstractLogin {\n  /**\n   * Used to manage the user's auth states. This should not be instantiated directly.\n   * Call {@link EmbeddedWalletSdk.auth} instead.\n   *\n   */\n  constructor(_ref) {\n    let {\n      querier,\n      preLogin,\n      postLogin,\n      clientId\n    } = _ref;\n    this.LoginQuerier = querier;\n    this.preLogin = preLogin;\n    this.postLogin = postLogin;\n    this.clientId = clientId;\n  }\n  async sendEmailLoginOtp(_ref2) {\n    let {\n      email\n    } = _ref2;\n    await this.preLogin();\n    const result = await this.LoginQuerier.call({\n      procedureName: \"sendThirdwebEmailLoginOtp\",\n      params: {\n        email\n      }\n    });\n    return result;\n  }\n}\n\nclass BaseLogin extends AbstractLogin {\n  constructor() {\n    super(...arguments);\n    (0,_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__._)(this, \"closeWindow\", _ref => {\n      let {\n        isWindowOpenedByFn,\n        win,\n        closeOpenedWindow\n      } = _ref;\n      if (isWindowOpenedByFn) {\n        win?.close();\n      } else {\n        if (win && closeOpenedWindow) {\n          closeOpenedWindow(win);\n        } else if (win) {\n          win.close();\n        }\n      }\n    });\n  }\n  async getOauthLoginUrl(authProvider) {\n    const result = await this.LoginQuerier.call({\n      procedureName: \"getHeadlessOauthLoginLink\",\n      params: {\n        authProvider\n      }\n    });\n    return result;\n  }\n  async loginWithModal() {\n    await this.preLogin();\n    const result = await this.LoginQuerier.call({\n      procedureName: \"loginWithThirdwebModal\",\n      params: undefined,\n      showIframe: true\n    });\n    return this.postLogin(result);\n  }\n  async loginWithEmailOtp(_ref2) {\n    let {\n      email\n    } = _ref2;\n    await this.preLogin();\n    const result = await this.LoginQuerier.call({\n      procedureName: \"loginWithThirdwebModal\",\n      params: {\n        email\n      },\n      showIframe: true\n    });\n    return this.postLogin(result);\n  }\n  getOauthPopUpSizing(authProvider) {\n    switch (authProvider) {\n      case AuthProvider.FACEBOOK:\n        return \"width=715, height=555\";\n      default:\n        return \"width=350, height=500\";\n    }\n  }\n  async loginWithOauth(args) {\n    let win = args?.openedWindow;\n    let isWindowOpenedByFn = false;\n    if (!win) {\n      win = window.open(\"\", \"Login\", this.getOauthPopUpSizing(args.oauthProvider));\n      isWindowOpenedByFn = true;\n    }\n    if (!win) {\n      throw new Error(\"Something went wrong opening pop-up\");\n    }\n    // logout the user\n    // fetch the url to open the login window from iframe\n    const [{\n      loginLink\n    }] = await Promise.all([this.getOauthLoginUrl(args.oauthProvider), this.preLogin()]);\n    win.location.href = loginLink;\n    // listen to result from the login window\n    const result = await new Promise((resolve, reject) => {\n      // detect when the user closes the login window\n      const pollTimer = window.setInterval(async () => {\n        if (!win) {\n          return;\n        }\n        if (win.closed) {\n          clearInterval(pollTimer);\n          window.removeEventListener(\"message\", messageListener);\n          reject(new Error(\"User closed login window\"));\n        }\n      }, 1000);\n      const messageListener = async event => {\n        if (event.origin !== GET_IFRAME_BASE_URL()) {\n          return;\n        }\n        if (typeof event.data !== \"object\") {\n          reject(new Error(\"Invalid event data\"));\n          return;\n        }\n        switch (event.data.eventType) {\n          case \"userLoginSuccess\":\n            {\n              window.removeEventListener(\"message\", messageListener);\n              clearInterval(pollTimer);\n              this.closeWindow({\n                isWindowOpenedByFn,\n                win,\n                closeOpenedWindow: args?.closeOpenedWindow\n              });\n              if (event.data.authResult) {\n                resolve(event.data.authResult);\n              }\n              break;\n            }\n          case \"userLoginFailed\":\n            {\n              window.removeEventListener(\"message\", messageListener);\n              clearInterval(pollTimer);\n              this.closeWindow({\n                isWindowOpenedByFn,\n                win,\n                closeOpenedWindow: args?.closeOpenedWindow\n              });\n              reject(new Error(event.data.error));\n              break;\n            }\n          case \"injectDeveloperClientId\":\n            {\n              win?.postMessage({\n                eventType: \"injectDeveloperClientIdResult\",\n                developerClientId: this.clientId,\n                authOption: args.oauthProvider\n              }, GET_IFRAME_BASE_URL());\n              break;\n            }\n        }\n      };\n      window.addEventListener(\"message\", messageListener);\n    });\n    return this.postLogin({\n      storedToken: {\n        ...result.storedToken,\n        shouldStoreCookieString: true\n      },\n      walletDetails: {\n        ...result.walletDetails,\n        isIframeStorageEnabled: false\n      }\n    });\n  }\n  async loginWithCustomJwt(_ref3) {\n    let {\n      encryptionKey,\n      jwt\n    } = _ref3;\n    const result = await this.LoginQuerier.call({\n      procedureName: \"loginWithCustomJwt\",\n      params: {\n        encryptionKey,\n        jwt\n      }\n    });\n    return this.postLogin(result);\n  }\n  async verifyEmailLoginOtp(_ref4) {\n    let {\n      email,\n      otp,\n      recoveryCode\n    } = _ref4;\n    const result = await this.LoginQuerier.call({\n      procedureName: \"verifyThirdwebEmailLoginOtp\",\n      params: {\n        email,\n        otp,\n        recoveryCode\n      }\n    });\n    return this.postLogin(result);\n  }\n}\n\nclass Auth {\n  /**\n   * Used to manage the user's auth states. This should not be instantiated directly.\n   * Call {@link EmbeddedWalletSdk.auth} instead.\n   */\n  constructor(_ref) {\n    let {\n      clientId,\n      querier,\n      onAuthSuccess\n    } = _ref;\n    this.clientId = clientId;\n    this.AuthQuerier = querier;\n    this.localStorage = new LocalStorage({\n      clientId\n    });\n    this.onAuthSuccess = onAuthSuccess;\n    this.BaseLogin = new BaseLogin({\n      postLogin: async result => {\n        return this.postLogin(result);\n      },\n      preLogin: async () => {\n        await this.preLogin();\n      },\n      querier: querier,\n      clientId\n    });\n  }\n  async preLogin() {\n    await this.logout();\n  }\n  async postLogin(_ref2) {\n    let {\n      storedToken,\n      walletDetails\n    } = _ref2;\n    if (storedToken.shouldStoreCookieString) {\n      await this.localStorage.saveAuthCookie(storedToken.cookieString);\n    }\n    const initializedUser = await this.onAuthSuccess({\n      storedToken,\n      walletDetails\n    });\n    return initializedUser;\n  }\n\n  /**\n   * Used to log the user into their thirdweb wallet on your platform via a myriad of auth providers\n   *\n   * @example\n   * ```typescript\n   * const thirdwebEmbeddedWallet = new EmbeddedWalletSdk({clientId: \"YOUR_CLIENT_ID\", chain: \"Polygon\"})\n   * try {\n   *   const user = await thirdwebEmbeddedWallet.auth.loginWithModal();\n   *   // user is now logged in\n   * } catch (e) {\n   *   // User closed modal or something else went wrong during the authentication process\n   *   console.error(e)\n   * }\n   * ```\n   *\n   * @returns `{{user: InitializedUser}}` An InitializedUser object. See {@link EmbeddedWalletSdk.getUser} for more\n   */\n  async loginWithModal() {\n    await this.preLogin();\n    return this.BaseLogin.loginWithModal();\n  }\n\n  /**\n   * Used to log the user into their thirdweb wallet using email OTP\n   *\n   * @example\n   * ```typescript\n   *  // Basic Flow\n   *  const thirdwebEmbeddedWallet = new EmbeddedWalletSdk({clientId: \"\", chain: \"Polygon\"});\n   *  try {\n   *    // prompts user to enter the code they received\n   *    const user = await thirdwebEmbeddedWallet.auth.loginWithThirdwebEmailOtp({ email : \"you@example.com\" });\n   *    // user is now logged in\n   *  } catch (e) {\n   *    // User closed the OTP modal or something else went wrong during the authentication process\n   *    console.error(e)\n   *  }\n   * ```\n   *\n   * @param args - args.email: We will send the email an OTP that needs to be entered in order for them to be logged in.\n   * @returns `{{user: InitializedUser}}` An InitializedUser object. See {@link EmbeddedWalletSdk.getUser} for more\n   */\n  async loginWithEmailOtp(args) {\n    return this.BaseLogin.loginWithEmailOtp(args);\n  }\n  async loginWithCustomJwt(args) {\n    return this.BaseLogin.loginWithCustomJwt(args);\n  }\n  async loginWithOauth(args) {\n    return this.BaseLogin.loginWithOauth(args);\n  }\n\n  /**\n   * A headless way to send the users at the passed email an OTP code.\n   * You need to then call {@link Auth.verifyEmailLoginOtp} in order to complete the login process\n   *\n   * @example\n   * ```typescript\n   *  const thirdwebEmbeddedWallet = new EmbeddedWalletSdk({clientId: \"\", chain: \"Polygon\"});\n   *  // sends user an OTP code\n   * try {\n   *    await thirdwebEmbeddedWallet.auth.sendEmailLoginOtp({ email : \"you@example.com\" });\n   * } catch(e) {\n   *    // Error Sending user's email an OTP code\n   *    console.error(e);\n   * }\n   *\n   * // Then when your user is ready to verify their OTP\n   * try {\n   *    const user = await thirdwebEmbeddedWallet.auth.verifyEmailLoginOtp({ email: \"you@example.com\", otp: \"6-DIGIT_CODE_HERE\" });\n   * } catch(e) {\n   *    // Error verifying the OTP code\n   *    console.error(e)\n   * }\n   * ```\n   *\n   * @param param0 - param0.email We will send the email an OTP that needs to be entered in order for them to be logged in.\n   * @returns `{{ isNewUser: boolean }}` IsNewUser indicates if the user is a new user to your platform\n   */\n  async sendEmailLoginOtp(_ref3) {\n    let {\n      email\n    } = _ref3;\n    return this.BaseLogin.sendEmailLoginOtp({\n      email\n    });\n  }\n\n  /**\n   * Used to verify the otp that the user receives from thirdweb\n   *\n   * See {@link Auth.sendEmailLoginOtp} for how the headless call flow looks like. Simply swap out the calls to `loginWithThirdwebEmailOtp` with `verifyThirdwebEmailLoginOtp`\n   *\n   * @param args - props.email We will send the email an OTP that needs to be entered in order for them to be logged in.\n   * props.otp The code that the user received in their email\n   * @returns `{{user: InitializedUser}}` An InitializedUser object containing the user's status, wallet, authDetails, and more\n   */\n  async verifyEmailLoginOtp(args) {\n    return this.BaseLogin.verifyEmailLoginOtp(args);\n  }\n\n  /**\n   * Logs any existing user out of their wallet.\n   * @returns `{{success: boolean}}` true if a user is successfully logged out. false if there's no user currently logged in.\n   */\n  async logout() {\n    const {\n      success\n    } = await this.AuthQuerier.call({\n      procedureName: \"logout\",\n      params: undefined\n    });\n    const isRemoveAuthCookie = await this.localStorage.removeAuthCookie();\n    const isRemoveUserId = await this.localStorage.removeWalletUserId();\n    return {\n      success: success || isRemoveAuthCookie || isRemoveUserId\n    };\n  }\n}\n\nclass EthersSigner extends ethers__WEBPACK_IMPORTED_MODULE_2__.Signer {\n  constructor(_ref) {\n    let {\n      provider,\n      clientId,\n      querier\n    } = _ref;\n    super();\n    (0,_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__._)(this, \"DEFAULT_ETHEREUM_CHAIN_ID\", 5);\n    this.clientId = clientId;\n    this.querier = querier;\n    // we try to extract a url if possible\n    this.endpoint = provider.connection?.url;\n    (0,ethers_lib_utils__WEBPACK_IMPORTED_MODULE_3__.defineReadOnly)(this, \"provider\", provider);\n  }\n  async getAddress() {\n    const {\n      address\n    } = await this.querier.call({\n      procedureName: \"getAddress\",\n      params: undefined\n    });\n    return address;\n  }\n  async signMessage(message) {\n    const {\n      signedMessage\n    } = await this.querier.call({\n      procedureName: \"signMessage\",\n      params: {\n        message,\n        chainId: (await this.provider?.getNetwork())?.chainId ?? this.DEFAULT_ETHEREUM_CHAIN_ID,\n        rpcEndpoint: this.endpoint\n      }\n    });\n    return signedMessage;\n  }\n  async signTransaction(transaction) {\n    const {\n      signedTransaction\n    } = await this.querier.call({\n      procedureName: \"signTransaction\",\n      params: {\n        transaction,\n        chainId: (await this.provider?.getNetwork())?.chainId ?? this.DEFAULT_ETHEREUM_CHAIN_ID,\n        rpcEndpoint: this.endpoint\n      }\n    });\n    return signedTransaction;\n  }\n  async _signTypedData(domain, types, message) {\n    const {\n      signedTypedData\n    } = await this.querier.call({\n      procedureName: \"signTypedDataV4\",\n      params: {\n        domain,\n        types,\n        message,\n        chainId: (await this.provider?.getNetwork())?.chainId ?? this.DEFAULT_ETHEREUM_CHAIN_ID,\n        rpcEndpoint: this.endpoint\n      }\n    });\n    return signedTypedData;\n  }\n  connect(provider) {\n    return new EthersSigner({\n      clientId: this.clientId,\n      provider,\n      querier: this.querier\n    });\n  }\n}\n\nclass EmbeddedWallet {\n  /**\n   * Not meant to be initialized directly. Call {@link initializeUser} to get an instance\n   */\n  constructor(_ref) {\n    let {\n      clientId,\n      chain,\n      querier\n    } = _ref;\n    this.clientId = clientId;\n    this.chain = chain;\n    this.walletManagerQuerier = querier;\n    this.localStorage = new LocalStorage({\n      clientId\n    });\n  }\n\n  /**\n   * @internal\n   * Used to set-up the user device in the case that they are using incognito\n   * @returns `{walletAddress : string }` The user's wallet details\n   */\n  async postWalletSetUp(_ref2) {\n    let {\n      deviceShareStored,\n      walletAddress,\n      isIframeStorageEnabled,\n      walletUserId\n    } = _ref2;\n    if (!isIframeStorageEnabled) {\n      await this.localStorage.saveDeviceShare(deviceShareStored, walletUserId);\n    }\n    return {\n      walletAddress\n    };\n  }\n\n  /**\n   * @internal\n   * Gets the various status states of the user\n   * @example\n   * ```typescript\n   *  const userStatus = await Paper.getUserWalletStatus();\n   *  switch (userStatus.status) {\n   *  case UserWalletStatus.LOGGED_OUT: {\n   *    // User is logged out, call one of the auth methods on Paper.auth to authenticate the user\n   *    break;\n   *  }\n   *  case UserWalletStatus.LOGGED_IN_WALLET_UNINITIALIZED: {\n   *    // User is logged in, but does not have a wallet associated with it\n   *    // you also have access to the user's details\n   *    userStatus.user.authDetails;\n   *    break;\n   *  }\n   *  case UserWalletStatus.LOGGED_IN_NEW_DEVICE: {\n   *    // User is logged in and created a wallet already, but is missing the device shard\n   *    // You have access to:\n   *    userStatus.user.authDetails;\n   *    userStatus.user.walletAddress;\n   *    break;\n   *  }\n   *  case UserWalletStatus.LOGGED_IN_WALLET_INITIALIZED: {\n   *    // user is logged in and wallet is all set up.\n   *    // You have access to:\n   *    userStatus.user.authDetails;\n   *    userStatus.user.walletAddress;\n   *    userStatus.user.wallet;\n   *    break;\n   *  }\n   *}\n   *```\n   * @returns `{GetUserWalletStatusFnReturnType}` an object to containing various information on the user statuses\n   */\n  async getUserWalletStatus() {\n    const userStatus = await this.walletManagerQuerier.call({\n      procedureName: \"getUserStatus\",\n      params: undefined\n    });\n    if (userStatus.status === UserWalletStatus.LOGGED_IN_WALLET_INITIALIZED) {\n      return {\n        status: UserWalletStatus.LOGGED_IN_WALLET_INITIALIZED,\n        ...userStatus.user,\n        wallet: this\n      };\n    } else if (userStatus.status === UserWalletStatus.LOGGED_IN_NEW_DEVICE) {\n      return {\n        status: UserWalletStatus.LOGGED_IN_WALLET_UNINITIALIZED,\n        ...userStatus.user\n      };\n    } else if (userStatus.status === UserWalletStatus.LOGGED_IN_WALLET_UNINITIALIZED) {\n      return {\n        status: UserWalletStatus.LOGGED_IN_WALLET_UNINITIALIZED,\n        ...userStatus.user\n      };\n    } else {\n      // Logged out\n      return {\n        status: userStatus.status\n      };\n    }\n  }\n\n  /**\n   * Switches the chain that the user wallet is currently on.\n   *\n   * @example\n   * ```typescript\n   * // user wallet will be set to Polygon\n   * const Paper = new ThirdwebEmbeddedWalletSdk({clientId: \"\", chain: \"Polygon\"});\n   * const user = await Paper.initializeUser();\n   * // Switch the user wallet to Mumbai\n   * await user.wallet.setChain({ chain: \"Mumbai\" });\n   * ```\n   * @param param0 - The chain that we are changing the user wallet too\n   */\n  async setChain(_ref3) {\n    let {\n      chain\n    } = _ref3;\n    this.chain = chain;\n  }\n\n  /**\n   * Returns an Ethers.Js compatible signer that you can use in conjunction with the rest of dApp\n   * @example\n   * ```typescript\n   * const Paper = new ThirdwebEmbeddedWalletSdk({clientId: \"\", chain: \"Polygon\"});\n   * const user = await Paper.getUser();\n   * if (user.status === UserStatus.LOGGED_IN_WALLET_INITIALIZED) {\n   *    // returns a signer on the Polygon mainnet\n   *    const signer = await user.getEthersJsSigner();\n   *    // returns a signer on the specified RPC endpoints\n   *    const signer = await user.getEthersJsSigner({rpcEndpoint: \"https://eth-rpc.gateway.pokt.network\"});\n   * }\n   * ```\n   * @param network - object with the rpc url where calls will be routed through\n   * @throws If attempting to call the function without the user wallet initialize on their current device. This should never happen if call {@link ThirdwebEmbeddedWalletSdk.initializeUser} before accessing this function\n   * @returns A signer that is compatible with Ether.js. Defaults to the public rpc on the chain specified when initializing the {@link ThirdwebEmbeddedWalletSdk} instance\n   */\n  async getEthersJsSigner(network) {\n    const signer = new EthersSigner({\n      clientId: this.clientId,\n      provider: (0,ethers__WEBPACK_IMPORTED_MODULE_4__.getDefaultProvider)(network?.rpcEndpoint ?? _paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.ChainToPublicRpc[this.chain]),\n      querier: this.walletManagerQuerier\n    });\n    return signer;\n  }\n}\n\nclass EmbeddedWalletSdk {\n  /**\n   * Used to manage the Auth state of the user.\n   */\n\n  isClientIdLegacyPaper(clientId) {\n    if (clientId.indexOf(\"-\") > 0 && clientId.length === 36) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * @example\n   * `const thirdwebEmbeddedWallet = new EmbeddedWalletSdk({ clientId: \"\", chain: \"Goerli\" });`\n   * @param param0 - EmbeddedWalletConstructorType\n   */\n  constructor(_ref) {\n    let {\n      clientId,\n      chain,\n      styles,\n      onAuthSuccess\n    } = _ref;\n    if (this.isClientIdLegacyPaper(clientId)) {\n      throw new Error(\"You are using a legacy clientId. Please use the clientId found on the thirdweb dashboard settings page\");\n    }\n    this.clientId = clientId;\n    this.querier = new EmbeddedWalletIframeCommunicator({\n      clientId,\n      customizationOptions: styles\n    });\n    this.wallet = new EmbeddedWallet({\n      clientId,\n      chain,\n      querier: this.querier\n    });\n    this.auth = new Auth({\n      clientId,\n      querier: this.querier,\n      onAuthSuccess: async authResult => {\n        onAuthSuccess?.(authResult);\n        await this.wallet.postWalletSetUp({\n          ...authResult.walletDetails,\n          walletUserId: authResult.storedToken.authDetails.userWalletId\n        });\n        await this.querier.call({\n          procedureName: \"initIframe\",\n          params: {\n            deviceShareStored: authResult.walletDetails.deviceShareStored,\n            clientId: this.clientId,\n            walletUserId: authResult.storedToken.authDetails.userWalletId,\n            authCookie: authResult.storedToken.cookieString\n          }\n        });\n        return {\n          user: {\n            status: UserWalletStatus.LOGGED_IN_WALLET_INITIALIZED,\n            authDetails: authResult.storedToken.authDetails,\n            wallet: this.wallet,\n            walletAddress: authResult.walletDetails.walletAddress\n          }\n        };\n      }\n    });\n  }\n\n  /**\n   * Gets the usr if they are logged in\n   * @example\n   * ```js\n   *  const user = await thirdwebEmbeddedWallet.getUser();\n   *  switch (user.status) {\n   *     case UserWalletStatus.LOGGED_OUT: {\n   *       // User is logged out, call one of the auth methods on thirdwebEmbeddedWallet.auth to authenticate the user\n   *       break;\n   *     }\n   *     case UserWalletStatus.LOGGED_IN_WALLET_INITIALIZED: {\n   *       // user is logged in and wallet is all set up.\n   *       // You have access to:\n   *       user.status;\n   *       user.authDetails;\n   *       user.walletAddress;\n   *       user.wallet;\n   *       break;\n   *     }\n   * }\n   * ```\n   * @returns GetUser - an object to containing various information on the user statuses\n   */\n  async getUser() {\n    return this.wallet.getUserWalletStatus();\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3JlYWN0L25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3dhbGxldHMvZGlzdC9lbWJlZGRlZC13YWxsZXQtMzBiZTljMDkuYnJvd3Nlci5lc20uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXFGO0FBQ0w7QUFDNUI7QUFDRjs7QUFFbEQ7QUFDQSxxQ0FBcUMsaUZBQWlCLDREQUE0RDtBQUNsSCwyRkFBMkYsU0FBUztBQUNwRyxpRkFBaUYsU0FBUztBQUMxRjtBQUNBO0FBQ0EsWUFBWSxnQ0FBZ0MsR0FBRyxTQUFTO0FBQ3hEO0FBQ0E7QUFDQSxpRUFBaUUsa0NBQWtDLEdBQUcsU0FBUyxHQUFHLE9BQU87QUFDekgsa0VBQWtFLGtDQUFrQyxHQUFHLFNBQVM7O0FBRWhIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxHQUFHO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsR0FBRzs7QUFFSjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEdBQUc7O0FBRUo7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOLElBQUksMEVBQWU7QUFDbkI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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dC9ub2RlX21vZHVsZXMvQHRoaXJkd2ViLWRldi93YWxsZXRzL2Rpc3QvZW1iZWRkZWQtd2FsbGV0LTMwYmU5YzA5LmJyb3dzZXIuZXNtLmpzP2JiZWQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0UGFwZXJPcmlnaW5VcmwsIENoYWluVG9QdWJsaWNScGMgfSBmcm9tICdAcGFwZXJ4eXovc2RrLWNvbW1vbi11dGlsaXRpZXMnO1xuaW1wb3J0IHsgXyBhcyBfZGVmaW5lUHJvcGVydHkgfSBmcm9tICcuL2RlZmluZVByb3BlcnR5LWM4ZWNkYzA3LmJyb3dzZXIuZXNtLmpzJztcbmltcG9ydCB7IFNpZ25lciwgZ2V0RGVmYXVsdFByb3ZpZGVyIH0gZnJvbSAnZXRoZXJzJztcbmltcG9ydCB7IGRlZmluZVJlYWRPbmx5IH0gZnJvbSAnZXRoZXJzL2xpYi91dGlscyc7XG5cbmNvbnN0IEVNQkVEREVEX1dBTExFVF9QQVRIID0gXCIvc2RrLzIwMjItMDgtMTIvZW1iZWRkZWQtd2FsbGV0XCI7XG5jb25zdCBHRVRfSUZSQU1FX0JBU0VfVVJMID0gKCkgPT4gYCR7Z2V0UGFwZXJPcmlnaW5VcmwoKS5yZXBsYWNlKFwid2l0aHBhcGVyLmNvbVwiLCBcImVtYmVkZGVkLXdhbGxldC50aGlyZHdlYi5jb21cIil9YDtcbmNvbnN0IFdBTExFVF9VU0VSX0RFVEFJTFNfTE9DQUxfU1RPUkFHRV9OQU1FID0gY2xpZW50SWQgPT4gYHRoaXJkd2ViRXdzV2FsbGV0VXNlckRldGFpbHMtJHtjbGllbnRJZH1gO1xuY29uc3QgV0FMTEVUX1VTRVJfSURfTE9DQUxfU1RPUkFHRV9OQU1FID0gY2xpZW50SWQgPT4gYHRoaXJkd2ViRXdzV2FsbGV0VXNlcklkLSR7Y2xpZW50SWR9YDtcbmNvbnN0IEFVVEhfVE9LRU5fTE9DQUxfU1RPUkFHRV9QUkVGSVggPSBcIndhbGxldFRva2VuXCI7XG5jb25zdCBBVVRIX1RPS0VOX0xPQ0FMX1NUT1JBR0VfTkFNRSA9IGNsaWVudElkID0+IHtcbiAgcmV0dXJuIGAke0FVVEhfVE9LRU5fTE9DQUxfU1RPUkFHRV9QUkVGSVh9LSR7Y2xpZW50SWR9YDtcbn07XG5jb25zdCBERVZJQ0VfU0hBUkVfTE9DQUxfU1RPUkFHRV9QUkVGSVggPSBcImFcIjtcbmNvbnN0IERFVklDRV9TSEFSRV9MT0NBTF9TVE9SQUdFX05BTUUgPSAoY2xpZW50SWQsIHVzZXJJZCkgPT4gYCR7REVWSUNFX1NIQVJFX0xPQ0FMX1NUT1JBR0VfUFJFRklYfS0ke2NsaWVudElkfS0ke3VzZXJJZH1gO1xuY29uc3QgREVWSUNFX1NIQVJFX0xPQ0FMX1NUT1JBR0VfTkFNRV9ERVBSRUNBVEVEID0gY2xpZW50SWQgPT4gYCR7REVWSUNFX1NIQVJFX0xPQ0FMX1NUT1JBR0VfUFJFRklYfS0ke2NsaWVudElkfWA7XG5cbmxldCBSZWNvdmVyeVNoYXJlTWFuYWdlbWVudCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoUmVjb3ZlcnlTaGFyZU1hbmFnZW1lbnQpIHtcbiAgUmVjb3ZlcnlTaGFyZU1hbmFnZW1lbnRbXCJVU0VSX01BTkFHRURcIl0gPSBcIlVTRVJfTUFOQUdFRFwiO1xuICBSZWNvdmVyeVNoYXJlTWFuYWdlbWVudFtcIkNMT1VEX01BTkFHRURcIl0gPSBcIkFXU19NQU5BR0VEXCI7XG4gIHJldHVybiBSZWNvdmVyeVNoYXJlTWFuYWdlbWVudDtcbn0oe30pO1xubGV0IEF1dGhQcm92aWRlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoQXV0aFByb3ZpZGVyKSB7XG4gIEF1dGhQcm92aWRlcltcIkNPR05JVE9cIl0gPSBcIkNvZ25pdG9cIjtcbiAgQXV0aFByb3ZpZGVyW1wiR09PR0xFXCJdID0gXCJHb29nbGVcIjtcbiAgQXV0aFByb3ZpZGVyW1wiRU1BSUxfT1RQXCJdID0gXCJFbWFpbE90cFwiO1xuICBBdXRoUHJvdmlkZXJbXCJDVVNUT01fSldUXCJdID0gXCJDdXN0b21KV1RcIjtcbiAgQXV0aFByb3ZpZGVyW1wiRkFDRUJPT0tcIl0gPSBcIkZhY2Vib29rXCI7XG4gIEF1dGhQcm92aWRlcltcIkFQUExFXCJdID0gXCJBcHBsZVwiO1xuICByZXR1cm4gQXV0aFByb3ZpZGVyO1xufSh7fSk7XG5cbi8vIFRPRE86IENsZWFuIHVwIHRlY2ggZGVidCBvZiByYW5kb20gdHlwZSBPYmplY3RzXG4vLyBFLmcuIFN0b3JlZFRva2VuVHlwZSBpcyByZWFsbHkgbm90IHVzZWQgYW55d2hlcmUgYnV0IGl0IGV4aXN0cyBhcyB0aGlzIG9iamVjdCBmb3IgbGVnYWN5IHJlYXNvblxuXG4vLyBDbGFzcyBjb25zdHJ1Y3RvciB0eXBlc1xuLy8gdHlwZXMgZm9yIGNsYXNzIGNvbnN0cnVjdG9ycyBzdGlsbCBhIGxpdHRsZSBtZXNzeSByaWdodCBub3cuXG4vLyBPcGVuIHRvIFBScyBmcm9tIHdob2V2ZXIgc2VlcyB0aGlzIGFuZCBrbm93cyBvZiBhIGNsZWFuZXIgd2F5IHRvIGhhbmRsZSB0aGluZ3Ncbi8vIEF1dGggVHlwZXNcbi8vIEVtYmVkZGVkIFdhbGxldCBUeXBlc1xubGV0IFVzZXJXYWxsZXRTdGF0dXMgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKFVzZXJXYWxsZXRTdGF0dXMpIHtcbiAgVXNlcldhbGxldFN0YXR1c1tcIkxPR0dFRF9PVVRcIl0gPSBcIkxvZ2dlZCBPdXRcIjtcbiAgVXNlcldhbGxldFN0YXR1c1tcIkxPR0dFRF9JTl9XQUxMRVRfVU5JTklUSUFMSVpFRFwiXSA9IFwiTG9nZ2VkIEluLCBXYWxsZXQgVW5pbml0aWFsaXplZFwiO1xuICBVc2VyV2FsbGV0U3RhdHVzW1wiTE9HR0VEX0lOX05FV19ERVZJQ0VcIl0gPSBcIkxvZ2dlZCBJbiwgTmV3IERldmljZVwiO1xuICBVc2VyV2FsbGV0U3RhdHVzW1wiTE9HR0VEX0lOX1dBTExFVF9JTklUSUFMSVpFRFwiXSA9IFwiTG9nZ2VkIEluLCBXYWxsZXQgSW5pdGlhbGl6ZWRcIjtcbiAgcmV0dXJuIFVzZXJXYWxsZXRTdGF0dXM7XG59KHt9KTtcblxuLy8gISBUeXBlcyBzZWVtIHJlcGV0aXRpdmUsIGJ1dCB0aGUgbmFtZSBzaG91bGQgaWRlbnRpZnkgd2hpY2ggZ29lcyB3aGVyZVxuLy8gdGhpcyBpcyB0aGUgcmV0dXJuIHR5cGUgZnJvbSB0aGUgRW1iZWRkZWRXYWxsZXQgQ2xhc3MgZ2V0VXNlcldhbGxldFN0YXR1cyBtZXRob2QgaWZyYW1lIGNhbGxcbi8vIHRoaXMgaXMgdGhlIHJldHVybiB0eXBlIGZyb20gdGhlIEVtYmVkZGVkV2FsbGV0IENsYXNzIGdldFVzZXJXYWxsZXRTdGF0dXMgbWV0aG9kXG5cbmNvbnN0IGRhdGEgPSBuZXcgTWFwKCk7XG5jbGFzcyBMb2NhbFN0b3JhZ2Uge1xuICBjb25zdHJ1Y3RvcihfcmVmKSB7XG4gICAgbGV0IHtcbiAgICAgIGNsaWVudElkXG4gICAgfSA9IF9yZWY7XG4gICAgdGhpcy5pc1N1cHBvcnRlZCA9ICEhd2luZG93LmxvY2FsU3RvcmFnZTtcbiAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XG4gIH1cbiAgYXN5bmMgZ2V0SXRlbShrZXkpIHtcbiAgICBpZiAodGhpcy5pc1N1cHBvcnRlZCkge1xuICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZGF0YS5nZXQoa2V5KSA/PyBudWxsO1xuICAgIH1cbiAgfVxuICBhc3luYyBzZXRJdGVtKGtleSwgdmFsdWUpIHtcbiAgICBpZiAodGhpcy5pc1N1cHBvcnRlZCkge1xuICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGF0YS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgfVxuICB9XG4gIGFzeW5jIHJlbW92ZUl0ZW0oa2V5KSB7XG4gICAgY29uc3QgaXRlbSA9IGF3YWl0IHRoaXMuZ2V0SXRlbShrZXkpO1xuICAgIGlmICh0aGlzLmlzU3VwcG9ydGVkICYmIGl0ZW0pIHtcbiAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBhc3luYyBzYXZlQXV0aENvb2tpZShjb29raWUpIHtcbiAgICBhd2FpdCB0aGlzLnNldEl0ZW0oQVVUSF9UT0tFTl9MT0NBTF9TVE9SQUdFX05BTUUodGhpcy5jbGllbnRJZCksIGNvb2tpZSk7XG4gIH1cbiAgYXN5bmMgZ2V0QXV0aENvb2tpZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRJdGVtKEFVVEhfVE9LRU5fTE9DQUxfU1RPUkFHRV9OQU1FKHRoaXMuY2xpZW50SWQpKTtcbiAgfVxuICBhc3luYyByZW1vdmVBdXRoQ29va2llKCkge1xuICAgIHJldHVybiB0aGlzLnJlbW92ZUl0ZW0oQVVUSF9UT0tFTl9MT0NBTF9TVE9SQUdFX05BTUUodGhpcy5jbGllbnRJZCkpO1xuICB9XG4gIGFzeW5jIHNhdmVEZXZpY2VTaGFyZShzaGFyZSwgdXNlcklkKSB7XG4gICAgYXdhaXQgdGhpcy5zYXZlV2FsbGV0VXNlcklkKHVzZXJJZCk7XG4gICAgYXdhaXQgdGhpcy5zZXRJdGVtKERFVklDRV9TSEFSRV9MT0NBTF9TVE9SQUdFX05BTUUodGhpcy5jbGllbnRJZCwgdXNlcklkKSwgc2hhcmUpO1xuICB9XG4gIGFzeW5jIGdldERldmljZVNoYXJlKCkge1xuICAgIGNvbnN0IHVzZXJJZCA9IGF3YWl0IHRoaXMuZ2V0V2FsbGV0VXNlcklkKCk7XG4gICAgaWYgKHVzZXJJZCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0SXRlbShERVZJQ0VfU0hBUkVfTE9DQUxfU1RPUkFHRV9OQU1FKHRoaXMuY2xpZW50SWQsIHVzZXJJZCkpO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBhc3luYyByZW1vdmVEZXZpY2VTaGFyZSgpIHtcbiAgICBjb25zdCB1c2VySWQgPSBhd2FpdCB0aGlzLmdldFdhbGxldFVzZXJJZCgpO1xuICAgIGlmICh1c2VySWQpIHtcbiAgICAgIHJldHVybiB0aGlzLnJlbW92ZUl0ZW0oREVWSUNFX1NIQVJFX0xPQ0FMX1NUT1JBR0VfTkFNRSh0aGlzLmNsaWVudElkLCB1c2VySWQpKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGFzeW5jIGdldFdhbGxldFVzZXJJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRJdGVtKFdBTExFVF9VU0VSX0lEX0xPQ0FMX1NUT1JBR0VfTkFNRSh0aGlzLmNsaWVudElkKSk7XG4gIH1cbiAgYXN5bmMgc2F2ZVdhbGxldFVzZXJJZCh1c2VySWQpIHtcbiAgICBhd2FpdCB0aGlzLnNldEl0ZW0oV0FMTEVUX1VTRVJfSURfTE9DQUxfU1RPUkFHRV9OQU1FKHRoaXMuY2xpZW50SWQpLCB1c2VySWQpO1xuICB9XG4gIGFzeW5jIHJlbW92ZVdhbGxldFVzZXJJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5yZW1vdmVJdGVtKFdBTExFVF9VU0VSX0lEX0xPQ0FMX1NUT1JBR0VfTkFNRSh0aGlzLmNsaWVudElkKSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2xlZXAoc2Vjb25kcykge1xuICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgc2V0VGltZW91dChyZXNvbHZlLCBzZWNvbmRzICogMTAwMCk7XG4gIH0pO1xufVxuY29uc3QgaWZyYW1lQmFzZVN0eWxlID0ge1xuICBoZWlnaHQ6IFwiMTAwJVwiLFxuICB3aWR0aDogXCIxMDAlXCIsXG4gIGJvcmRlcjogXCJub25lXCIsXG4gIGJhY2tncm91bmRDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxuICBjb2xvclNjaGVtZTogXCJsaWdodFwiLFxuICBwb3NpdGlvbjogXCJmaXhlZFwiLFxuICB0b3A6IFwiMHB4XCIsXG4gIHJpZ2h0OiBcIjBweFwiLFxuICB6SW5kZXg6IFwiMjE0NzQ4MzY0NlwiLFxuICBkaXNwbGF5OiBcIm5vbmVcIlxufTtcblxuLy8gR2xvYmFsIHZhciB0byBoZWxwIHRyYWNrIGlmcmFtZSBzdGF0ZVxuY29uc3QgaXNJZnJhbWVMb2FkZWQgPSBuZXcgTWFwKCk7XG5jbGFzcyBJZnJhbWVDb21tdW5pY2F0b3Ige1xuICBjb25zdHJ1Y3RvcihfcmVmKSB7XG4gICAgbGV0IHtcbiAgICAgIGxpbmssXG4gICAgICBpZnJhbWVJZCxcbiAgICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LmJvZHksXG4gICAgICBpZnJhbWVTdHlsZXMsXG4gICAgICBvbklmcmFtZUluaXRpYWxpemVcbiAgICB9ID0gX3JlZjtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJQT0xMSU5HX0lOVEVSVkFMX1NFQ09ORFNcIiwgMS40KTtcbiAgICB0aGlzLmlmcmFtZUJhc2VVcmwgPSBHRVRfSUZSQU1FX0JBU0VfVVJMKCk7XG5cbiAgICAvLyBDcmVhdGluZyB0aGUgSUZyYW1lIGVsZW1lbnQgZm9yIGNvbW11bmljYXRpb25cbiAgICBsZXQgaWZyYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWZyYW1lSWQpO1xuICAgIGNvbnN0IGhyZWZMaW5rID0gbmV3IFVSTChsaW5rKTtcbiAgICBjb25zdCBzZGtWZXJzaW9uID0gXCIyLjEuOVwiO1xuICAgIGhyZWZMaW5rLnNlYXJjaFBhcmFtcy5zZXQoXCJzZGtWZXJzaW9uXCIsIHNka1ZlcnNpb24pO1xuICAgIGlmICghaWZyYW1lIHx8IGlmcmFtZS5zcmMgIT09IGhyZWZMaW5rLmhyZWYpIHtcbiAgICAgIC8vICEgRG8gbm90IHVwZGF0ZSB0aGUgaHJlZkxpbmsgaGVyZSBvciBpdCdsbCBjYXVzZSBtdWx0aXBsZSByZS1yZW5kZXJzXG4gICAgICBpZiAoIWlmcmFtZSkge1xuICAgICAgICBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xuICAgICAgICBjb25zdCBtZXJnZWRJZnJhbWVTdHlsZXMgPSB7XG4gICAgICAgICAgLi4uaWZyYW1lQmFzZVN0eWxlLFxuICAgICAgICAgIC4uLmlmcmFtZVN0eWxlc1xuICAgICAgICB9O1xuICAgICAgICBPYmplY3QuYXNzaWduKGlmcmFtZS5zdHlsZSwgbWVyZ2VkSWZyYW1lU3R5bGVzKTtcbiAgICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcImlkXCIsIGlmcmFtZUlkKTtcbiAgICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcImZldGNocHJpb3JpdHlcIiwgXCJoaWdoXCIpO1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcbiAgICAgIH1cbiAgICAgIGlmcmFtZS5zcmMgPSBocmVmTGluay5ocmVmO1xuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcImRhdGEtdmVyc2lvblwiLCBzZGtWZXJzaW9uKTtcbiAgICAgIGNvbnN0IG9uSWZyYW1lTG9hZGVkID0gZXZlbnQgPT4ge1xuICAgICAgICBpZiAoZXZlbnQuZGF0YS5ldmVudFR5cGUgPT09IFwiZXdzSWZyYW1lTG9hZGVkXCIpIHtcbiAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgb25JZnJhbWVMb2FkZWQpO1xuICAgICAgICAgIGlmICghaWZyYW1lKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCJ0aGlyZHdlYiBJZnJhbWUgbm90IGZvdW5kXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLm9uSWZyYW1lTG9hZEhhbmRsZXIoaWZyYW1lLCBvbklmcmFtZUluaXRpYWxpemUpKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgb25JZnJhbWVMb2FkZWQpO1xuICAgIH1cbiAgICB0aGlzLmlmcmFtZSA9IGlmcmFtZTtcbiAgfVxuICBhc3luYyBvbklmcmFtZUxvYWRlZEluaXRWYXJpYWJsZXMoKSB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG4gIG9uSWZyYW1lTG9hZEhhbmRsZXIoaWZyYW1lLCBvbklmcmFtZUluaXRpYWxpemUpIHtcbiAgICByZXR1cm4gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGFzeW5jIChyZXMsIHJlaikgPT4ge1xuICAgICAgICBjb25zdCBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG4gICAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZXZlbnQgPT4ge1xuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGRhdGFcbiAgICAgICAgICB9ID0gZXZlbnQ7XG4gICAgICAgICAgY2hhbm5lbC5wb3J0MS5jbG9zZSgpO1xuICAgICAgICAgIGlmICghZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVqKG5ldyBFcnJvcihkYXRhLmVycm9yKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlzSWZyYW1lTG9hZGVkLnNldChpZnJhbWUuc3JjLCB0cnVlKTtcbiAgICAgICAgICBpZiAob25JZnJhbWVJbml0aWFsaXplKSB7XG4gICAgICAgICAgICBvbklmcmFtZUluaXRpYWxpemUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlcyh0cnVlKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgSU5JVF9JRlJBTUVfRVZFTlQgPSBcImluaXRJZnJhbWVcIjtcbiAgICAgICAgaWZyYW1lPy5jb250ZW50V2luZG93Py5wb3N0TWVzc2FnZShcbiAgICAgICAgLy8gPyBXZSBpbml0aWFsaXNlIHRoZSBpZnJhbWUgd2l0aCBhIGJ1bmNoXG4gICAgICAgIC8vIG9mIHVzZWZ1bCBpbmZvcm1hdGlvbiBzbyB0aGF0IHdlIGRvbid0IGhhdmUgdG8gcGFzcyBpdFxuICAgICAgICAvLyB0aHJvdWdoIGluIGVhY2ggb2YgdGhlIGZ1dHVyZSBjYWxsLiBUaGlzIHdvdWxkIGJlIHdoZXJlIHdlIGRvIGl0LlxuICAgICAgICB7XG4gICAgICAgICAgZXZlbnRUeXBlOiBJTklUX0lGUkFNRV9FVkVOVCxcbiAgICAgICAgICBkYXRhOiBhd2FpdCB0aGlzLm9uSWZyYW1lTG9hZGVkSW5pdFZhcmlhYmxlcygpXG4gICAgICAgIH0sIHRoaXMuaWZyYW1lQmFzZVVybCwgW2NoYW5uZWwucG9ydDJdKTtcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgcHJvbWlzZTtcbiAgICB9O1xuICB9XG4gIGFzeW5jIGNhbGwoX3JlZjIpIHtcbiAgICBsZXQge1xuICAgICAgcHJvY2VkdXJlTmFtZSxcbiAgICAgIHBhcmFtcyxcbiAgICAgIHNob3dJZnJhbWUgPSBmYWxzZVxuICAgIH0gPSBfcmVmMjtcbiAgICB3aGlsZSAoIWlzSWZyYW1lTG9hZGVkLmdldCh0aGlzLmlmcmFtZS5zcmMpKSB7XG4gICAgICBhd2FpdCBzbGVlcCh0aGlzLlBPTExJTkdfSU5URVJWQUxfU0VDT05EUyk7XG4gICAgfVxuICAgIGlmIChzaG93SWZyYW1lKSB7XG4gICAgICB0aGlzLmlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xuICAgICAgLy8gbWFnaWMgbnVtYmVyIHRvIGxldCB0aGUgZGlzcGxheSByZW5kZXIgYmVmb3JlIHBlcmZvcm1pbmcgdGhlIGFuaW1hdGlvbiBvZiB0aGUgbW9kYWwgaW5cbiAgICAgIGF3YWl0IHNsZWVwKDAuMDA1KTtcbiAgICB9XG4gICAgY29uc3QgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4ge1xuICAgICAgY29uc3QgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpO1xuICAgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBhc3luYyBldmVudCA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBkYXRhXG4gICAgICAgIH0gPSBldmVudDtcbiAgICAgICAgY2hhbm5lbC5wb3J0MS5jbG9zZSgpO1xuICAgICAgICBpZiAoc2hvd0lmcmFtZSkge1xuICAgICAgICAgIC8vIG1hZ2ljIG51bWJlciB0byBsZXQgbW9kYWwgZmFkZSBvdXQgYmVmb3JlIGhpZGluZyBpdFxuICAgICAgICAgIGF3YWl0IHNsZWVwKDAuMSk7XG4gICAgICAgICAgdGhpcy5pZnJhbWUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgcmVqKG5ldyBFcnJvcihkYXRhLmVycm9yKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzKGRhdGEuZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB0aGlzLmlmcmFtZS5jb250ZW50V2luZG93Py5wb3N0TWVzc2FnZSh7XG4gICAgICAgIGV2ZW50VHlwZTogcHJvY2VkdXJlTmFtZSxcbiAgICAgICAgZGF0YTogcGFyYW1zXG4gICAgICB9LCB0aGlzLmlmcmFtZUJhc2VVcmwsIFtjaGFubmVsLnBvcnQyXSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBoYXMgdG8gYmUgY2FsbGVkIGJ5IGFueSBpZnJhbWUgdGhhdCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NLlxuICAgKiBVc2UgdG8gbWFrZSBzdXJlIHRoYXQgd2UgcmVzZXQgdGhlIGdsb2JhbCBsb2FkZWQgc3RhdGUgb2YgdGhlIHBhcnRpY3VsYXIgaWZyYW1lLnNyY1xuICAgKi9cbiAgZGVzdHJveSgpIHtcbiAgICBpc0lmcmFtZUxvYWRlZC5kZWxldGUodGhpcy5pZnJhbWUuc3JjKTtcbiAgfVxufVxuXG5jbGFzcyBFbWJlZGRlZFdhbGxldElmcmFtZUNvbW11bmljYXRvciBleHRlbmRzIElmcmFtZUNvbW11bmljYXRvciB7XG4gIGNvbnN0cnVjdG9yKF9yZWYpIHtcbiAgICBsZXQge1xuICAgICAgY2xpZW50SWQsXG4gICAgICBjdXN0b21pemF0aW9uT3B0aW9uc1xuICAgIH0gPSBfcmVmO1xuICAgIHN1cGVyKHtcbiAgICAgIGlmcmFtZUlkOiBFTUJFRERFRF9XQUxMRVRfSUZSQU1FX0lELFxuICAgICAgbGluazogY3JlYXRlRW1iZWRkZWRXYWxsZXRJZnJhbWVMaW5rKHtcbiAgICAgICAgY2xpZW50SWQsXG4gICAgICAgIHBhdGg6IEVNQkVEREVEX1dBTExFVF9QQVRILFxuICAgICAgICBxdWVyeVBhcmFtczogY3VzdG9taXphdGlvbk9wdGlvbnNcbiAgICAgIH0pLmhyZWYsXG4gICAgICBjb250YWluZXI6IGRvY3VtZW50LmJvZHlcbiAgICB9KTtcbiAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XG4gIH1cbiAgYXN5bmMgb25JZnJhbWVMb2FkZWRJbml0VmFyaWFibGVzKCkge1xuICAgIGNvbnN0IGxvY2FsU3RvcmFnZSA9IG5ldyBMb2NhbFN0b3JhZ2Uoe1xuICAgICAgY2xpZW50SWQ6IHRoaXMuY2xpZW50SWRcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgYXV0aENvb2tpZTogYXdhaXQgbG9jYWxTdG9yYWdlLmdldEF1dGhDb29raWUoKSxcbiAgICAgIGRldmljZVNoYXJlU3RvcmVkOiBhd2FpdCBsb2NhbFN0b3JhZ2UuZ2V0RGV2aWNlU2hhcmUoKSxcbiAgICAgIHdhbGxldFVzZXJJZDogYXdhaXQgbG9jYWxTdG9yYWdlLmdldFdhbGxldFVzZXJJZCgpLFxuICAgICAgY2xpZW50SWQ6IHRoaXMuY2xpZW50SWRcbiAgICB9O1xuICB9XG59XG5cbi8vIFRoaXMgaXMgdGhlIFVSTCBhbmQgSUQgdGFnIG9mIHRoZSBpRnJhbWUgdGhhdCB3ZSBjb21tdW5pY2F0ZSB3aXRoXG5mdW5jdGlvbiBjcmVhdGVFbWJlZGRlZFdhbGxldElmcmFtZUxpbmsoX3JlZjIpIHtcbiAgbGV0IHtcbiAgICBjbGllbnRJZCxcbiAgICBwYXRoLFxuICAgIHF1ZXJ5UGFyYW1zXG4gIH0gPSBfcmVmMjtcbiAgY29uc3QgZW1iZWRkZWRXYWxsZXRVcmwgPSBuZXcgVVJMKGAke3BhdGh9YCwgR0VUX0lGUkFNRV9CQVNFX1VSTCgpKTtcbiAgaWYgKHF1ZXJ5UGFyYW1zKSB7XG4gICAgZm9yIChjb25zdCBxdWVyeUtleSBvZiBPYmplY3Qua2V5cyhxdWVyeVBhcmFtcykpIHtcbiAgICAgIGVtYmVkZGVkV2FsbGV0VXJsLnNlYXJjaFBhcmFtcy5zZXQocXVlcnlLZXksIHF1ZXJ5UGFyYW1zW3F1ZXJ5S2V5XT8udG9TdHJpbmcoKSB8fCBcIlwiKTtcbiAgICB9XG4gIH1cbiAgZW1iZWRkZWRXYWxsZXRVcmwuc2VhcmNoUGFyYW1zLnNldChcImNsaWVudElkXCIsIGNsaWVudElkKTtcbiAgcmV0dXJuIGVtYmVkZGVkV2FsbGV0VXJsO1xufVxuY29uc3QgRU1CRURERURfV0FMTEVUX0lGUkFNRV9JRCA9IFwidGhpcmR3ZWItZW1iZWRkZWQtd2FsbGV0LWlmcmFtZVwiO1xuXG5jbGFzcyBBYnN0cmFjdExvZ2luIHtcbiAgLyoqXG4gICAqIFVzZWQgdG8gbWFuYWdlIHRoZSB1c2VyJ3MgYXV0aCBzdGF0ZXMuIFRoaXMgc2hvdWxkIG5vdCBiZSBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuXG4gICAqIENhbGwge0BsaW5rIEVtYmVkZGVkV2FsbGV0U2RrLmF1dGh9IGluc3RlYWQuXG4gICAqXG4gICAqL1xuICBjb25zdHJ1Y3RvcihfcmVmKSB7XG4gICAgbGV0IHtcbiAgICAgIHF1ZXJpZXIsXG4gICAgICBwcmVMb2dpbixcbiAgICAgIHBvc3RMb2dpbixcbiAgICAgIGNsaWVudElkXG4gICAgfSA9IF9yZWY7XG4gICAgdGhpcy5Mb2dpblF1ZXJpZXIgPSBxdWVyaWVyO1xuICAgIHRoaXMucHJlTG9naW4gPSBwcmVMb2dpbjtcbiAgICB0aGlzLnBvc3RMb2dpbiA9IHBvc3RMb2dpbjtcbiAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XG4gIH1cbiAgYXN5bmMgc2VuZEVtYWlsTG9naW5PdHAoX3JlZjIpIHtcbiAgICBsZXQge1xuICAgICAgZW1haWxcbiAgICB9ID0gX3JlZjI7XG4gICAgYXdhaXQgdGhpcy5wcmVMb2dpbigpO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuTG9naW5RdWVyaWVyLmNhbGwoe1xuICAgICAgcHJvY2VkdXJlTmFtZTogXCJzZW5kVGhpcmR3ZWJFbWFpbExvZ2luT3RwXCIsXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgZW1haWxcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG5cbmNsYXNzIEJhc2VMb2dpbiBleHRlbmRzIEFic3RyYWN0TG9naW4ge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlciguLi5hcmd1bWVudHMpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNsb3NlV2luZG93XCIsIF9yZWYgPT4ge1xuICAgICAgbGV0IHtcbiAgICAgICAgaXNXaW5kb3dPcGVuZWRCeUZuLFxuICAgICAgICB3aW4sXG4gICAgICAgIGNsb3NlT3BlbmVkV2luZG93XG4gICAgICB9ID0gX3JlZjtcbiAgICAgIGlmIChpc1dpbmRvd09wZW5lZEJ5Rm4pIHtcbiAgICAgICAgd2luPy5jbG9zZSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHdpbiAmJiBjbG9zZU9wZW5lZFdpbmRvdykge1xuICAgICAgICAgIGNsb3NlT3BlbmVkV2luZG93KHdpbik7XG4gICAgICAgIH0gZWxzZSBpZiAod2luKSB7XG4gICAgICAgICAgd2luLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBhc3luYyBnZXRPYXV0aExvZ2luVXJsKGF1dGhQcm92aWRlcikge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuTG9naW5RdWVyaWVyLmNhbGwoe1xuICAgICAgcHJvY2VkdXJlTmFtZTogXCJnZXRIZWFkbGVzc09hdXRoTG9naW5MaW5rXCIsXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgYXV0aFByb3ZpZGVyXG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuICBhc3luYyBsb2dpbldpdGhNb2RhbCgpIHtcbiAgICBhd2FpdCB0aGlzLnByZUxvZ2luKCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5Mb2dpblF1ZXJpZXIuY2FsbCh7XG4gICAgICBwcm9jZWR1cmVOYW1lOiBcImxvZ2luV2l0aFRoaXJkd2ViTW9kYWxcIixcbiAgICAgIHBhcmFtczogdW5kZWZpbmVkLFxuICAgICAgc2hvd0lmcmFtZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLnBvc3RMb2dpbihyZXN1bHQpO1xuICB9XG4gIGFzeW5jIGxvZ2luV2l0aEVtYWlsT3RwKF9yZWYyKSB7XG4gICAgbGV0IHtcbiAgICAgIGVtYWlsXG4gICAgfSA9IF9yZWYyO1xuICAgIGF3YWl0IHRoaXMucHJlTG9naW4oKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLkxvZ2luUXVlcmllci5jYWxsKHtcbiAgICAgIHByb2NlZHVyZU5hbWU6IFwibG9naW5XaXRoVGhpcmR3ZWJNb2RhbFwiLFxuICAgICAgcGFyYW1zOiB7XG4gICAgICAgIGVtYWlsXG4gICAgICB9LFxuICAgICAgc2hvd0lmcmFtZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLnBvc3RMb2dpbihyZXN1bHQpO1xuICB9XG4gIGdldE9hdXRoUG9wVXBTaXppbmcoYXV0aFByb3ZpZGVyKSB7XG4gICAgc3dpdGNoIChhdXRoUHJvdmlkZXIpIHtcbiAgICAgIGNhc2UgQXV0aFByb3ZpZGVyLkZBQ0VCT09LOlxuICAgICAgICByZXR1cm4gXCJ3aWR0aD03MTUsIGhlaWdodD01NTVcIjtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiBcIndpZHRoPTM1MCwgaGVpZ2h0PTUwMFwiO1xuICAgIH1cbiAgfVxuICBhc3luYyBsb2dpbldpdGhPYXV0aChhcmdzKSB7XG4gICAgbGV0IHdpbiA9IGFyZ3M/Lm9wZW5lZFdpbmRvdztcbiAgICBsZXQgaXNXaW5kb3dPcGVuZWRCeUZuID0gZmFsc2U7XG4gICAgaWYgKCF3aW4pIHtcbiAgICAgIHdpbiA9IHdpbmRvdy5vcGVuKFwiXCIsIFwiTG9naW5cIiwgdGhpcy5nZXRPYXV0aFBvcFVwU2l6aW5nKGFyZ3Mub2F1dGhQcm92aWRlcikpO1xuICAgICAgaXNXaW5kb3dPcGVuZWRCeUZuID0gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKCF3aW4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlNvbWV0aGluZyB3ZW50IHdyb25nIG9wZW5pbmcgcG9wLXVwXCIpO1xuICAgIH1cbiAgICAvLyBsb2dvdXQgdGhlIHVzZXJcbiAgICAvLyBmZXRjaCB0aGUgdXJsIHRvIG9wZW4gdGhlIGxvZ2luIHdpbmRvdyBmcm9tIGlmcmFtZVxuICAgIGNvbnN0IFt7XG4gICAgICBsb2dpbkxpbmtcbiAgICB9XSA9IGF3YWl0IFByb21pc2UuYWxsKFt0aGlzLmdldE9hdXRoTG9naW5VcmwoYXJncy5vYXV0aFByb3ZpZGVyKSwgdGhpcy5wcmVMb2dpbigpXSk7XG4gICAgd2luLmxvY2F0aW9uLmhyZWYgPSBsb2dpbkxpbms7XG4gICAgLy8gbGlzdGVuIHRvIHJlc3VsdCBmcm9tIHRoZSBsb2dpbiB3aW5kb3dcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAvLyBkZXRlY3Qgd2hlbiB0aGUgdXNlciBjbG9zZXMgdGhlIGxvZ2luIHdpbmRvd1xuICAgICAgY29uc3QgcG9sbFRpbWVyID0gd2luZG93LnNldEludGVydmFsKGFzeW5jICgpID0+IHtcbiAgICAgICAgaWYgKCF3aW4pIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdpbi5jbG9zZWQpIHtcbiAgICAgICAgICBjbGVhckludGVydmFsKHBvbGxUaW1lcik7XG4gICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG1lc3NhZ2VMaXN0ZW5lcik7XG4gICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihcIlVzZXIgY2xvc2VkIGxvZ2luIHdpbmRvd1wiKSk7XG4gICAgICAgIH1cbiAgICAgIH0sIDEwMDApO1xuICAgICAgY29uc3QgbWVzc2FnZUxpc3RlbmVyID0gYXN5bmMgZXZlbnQgPT4ge1xuICAgICAgICBpZiAoZXZlbnQub3JpZ2luICE9PSBHRVRfSUZSQU1FX0JBU0VfVVJMKCkpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBldmVudC5kYXRhICE9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihcIkludmFsaWQgZXZlbnQgZGF0YVwiKSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAoZXZlbnQuZGF0YS5ldmVudFR5cGUpIHtcbiAgICAgICAgICBjYXNlIFwidXNlckxvZ2luU3VjY2Vzc1wiOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbWVzc2FnZUxpc3RlbmVyKTtcbiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChwb2xsVGltZXIpO1xuICAgICAgICAgICAgICB0aGlzLmNsb3NlV2luZG93KHtcbiAgICAgICAgICAgICAgICBpc1dpbmRvd09wZW5lZEJ5Rm4sXG4gICAgICAgICAgICAgICAgd2luLFxuICAgICAgICAgICAgICAgIGNsb3NlT3BlbmVkV2luZG93OiBhcmdzPy5jbG9zZU9wZW5lZFdpbmRvd1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgaWYgKGV2ZW50LmRhdGEuYXV0aFJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZXZlbnQuZGF0YS5hdXRoUmVzdWx0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIFwidXNlckxvZ2luRmFpbGVkXCI6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBtZXNzYWdlTGlzdGVuZXIpO1xuICAgICAgICAgICAgICBjbGVhckludGVydmFsKHBvbGxUaW1lcik7XG4gICAgICAgICAgICAgIHRoaXMuY2xvc2VXaW5kb3coe1xuICAgICAgICAgICAgICAgIGlzV2luZG93T3BlbmVkQnlGbixcbiAgICAgICAgICAgICAgICB3aW4sXG4gICAgICAgICAgICAgICAgY2xvc2VPcGVuZWRXaW5kb3c6IGFyZ3M/LmNsb3NlT3BlbmVkV2luZG93XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGV2ZW50LmRhdGEuZXJyb3IpKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgY2FzZSBcImluamVjdERldmVsb3BlckNsaWVudElkXCI6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHdpbj8ucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogXCJpbmplY3REZXZlbG9wZXJDbGllbnRJZFJlc3VsdFwiLFxuICAgICAgICAgICAgICAgIGRldmVsb3BlckNsaWVudElkOiB0aGlzLmNsaWVudElkLFxuICAgICAgICAgICAgICAgIGF1dGhPcHRpb246IGFyZ3Mub2F1dGhQcm92aWRlclxuICAgICAgICAgICAgICB9LCBHRVRfSUZSQU1FX0JBU0VfVVJMKCkpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBtZXNzYWdlTGlzdGVuZXIpO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLnBvc3RMb2dpbih7XG4gICAgICBzdG9yZWRUb2tlbjoge1xuICAgICAgICAuLi5yZXN1bHQuc3RvcmVkVG9rZW4sXG4gICAgICAgIHNob3VsZFN0b3JlQ29va2llU3RyaW5nOiB0cnVlXG4gICAgICB9LFxuICAgICAgd2FsbGV0RGV0YWlsczoge1xuICAgICAgICAuLi5yZXN1bHQud2FsbGV0RGV0YWlscyxcbiAgICAgICAgaXNJZnJhbWVTdG9yYWdlRW5hYmxlZDogZmFsc2VcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBhc3luYyBsb2dpbldpdGhDdXN0b21Kd3QoX3JlZjMpIHtcbiAgICBsZXQge1xuICAgICAgZW5jcnlwdGlvbktleSxcbiAgICAgIGp3dFxuICAgIH0gPSBfcmVmMztcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLkxvZ2luUXVlcmllci5jYWxsKHtcbiAgICAgIHByb2NlZHVyZU5hbWU6IFwibG9naW5XaXRoQ3VzdG9tSnd0XCIsXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgZW5jcnlwdGlvbktleSxcbiAgICAgICAgand0XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMucG9zdExvZ2luKHJlc3VsdCk7XG4gIH1cbiAgYXN5bmMgdmVyaWZ5RW1haWxMb2dpbk90cChfcmVmNCkge1xuICAgIGxldCB7XG4gICAgICBlbWFpbCxcbiAgICAgIG90cCxcbiAgICAgIHJlY292ZXJ5Q29kZVxuICAgIH0gPSBfcmVmNDtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLkxvZ2luUXVlcmllci5jYWxsKHtcbiAgICAgIHByb2NlZHVyZU5hbWU6IFwidmVyaWZ5VGhpcmR3ZWJFbWFpbExvZ2luT3RwXCIsXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG90cCxcbiAgICAgICAgcmVjb3ZlcnlDb2RlXG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMucG9zdExvZ2luKHJlc3VsdCk7XG4gIH1cbn1cblxuY2xhc3MgQXV0aCB7XG4gIC8qKlxuICAgKiBVc2VkIHRvIG1hbmFnZSB0aGUgdXNlcidzIGF1dGggc3RhdGVzLiBUaGlzIHNob3VsZCBub3QgYmUgaW5zdGFudGlhdGVkIGRpcmVjdGx5LlxuICAgKiBDYWxsIHtAbGluayBFbWJlZGRlZFdhbGxldFNkay5hdXRofSBpbnN0ZWFkLlxuICAgKi9cbiAgY29uc3RydWN0b3IoX3JlZikge1xuICAgIGxldCB7XG4gICAgICBjbGllbnRJZCxcbiAgICAgIHF1ZXJpZXIsXG4gICAgICBvbkF1dGhTdWNjZXNzXG4gICAgfSA9IF9yZWY7XG4gICAgdGhpcy5jbGllbnRJZCA9IGNsaWVudElkO1xuICAgIHRoaXMuQXV0aFF1ZXJpZXIgPSBxdWVyaWVyO1xuICAgIHRoaXMubG9jYWxTdG9yYWdlID0gbmV3IExvY2FsU3RvcmFnZSh7XG4gICAgICBjbGllbnRJZFxuICAgIH0pO1xuICAgIHRoaXMub25BdXRoU3VjY2VzcyA9IG9uQXV0aFN1Y2Nlc3M7XG4gICAgdGhpcy5CYXNlTG9naW4gPSBuZXcgQmFzZUxvZ2luKHtcbiAgICAgIHBvc3RMb2dpbjogYXN5bmMgcmVzdWx0ID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9zdExvZ2luKHJlc3VsdCk7XG4gICAgICB9LFxuICAgICAgcHJlTG9naW46IGFzeW5jICgpID0+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5wcmVMb2dpbigpO1xuICAgICAgfSxcbiAgICAgIHF1ZXJpZXI6IHF1ZXJpZXIsXG4gICAgICBjbGllbnRJZFxuICAgIH0pO1xuICB9XG4gIGFzeW5jIHByZUxvZ2luKCkge1xuICAgIGF3YWl0IHRoaXMubG9nb3V0KCk7XG4gIH1cbiAgYXN5bmMgcG9zdExvZ2luKF9yZWYyKSB7XG4gICAgbGV0IHtcbiAgICAgIHN0b3JlZFRva2VuLFxuICAgICAgd2FsbGV0RGV0YWlsc1xuICAgIH0gPSBfcmVmMjtcbiAgICBpZiAoc3RvcmVkVG9rZW4uc2hvdWxkU3RvcmVDb29raWVTdHJpbmcpIHtcbiAgICAgIGF3YWl0IHRoaXMubG9jYWxTdG9yYWdlLnNhdmVBdXRoQ29va2llKHN0b3JlZFRva2VuLmNvb2tpZVN0cmluZyk7XG4gICAgfVxuICAgIGNvbnN0IGluaXRpYWxpemVkVXNlciA9IGF3YWl0IHRoaXMub25BdXRoU3VjY2Vzcyh7XG4gICAgICBzdG9yZWRUb2tlbixcbiAgICAgIHdhbGxldERldGFpbHNcbiAgICB9KTtcbiAgICByZXR1cm4gaW5pdGlhbGl6ZWRVc2VyO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgdG8gbG9nIHRoZSB1c2VyIGludG8gdGhlaXIgdGhpcmR3ZWIgd2FsbGV0IG9uIHlvdXIgcGxhdGZvcm0gdmlhIGEgbXlyaWFkIG9mIGF1dGggcHJvdmlkZXJzXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3QgdGhpcmR3ZWJFbWJlZGRlZFdhbGxldCA9IG5ldyBFbWJlZGRlZFdhbGxldFNkayh7Y2xpZW50SWQ6IFwiWU9VUl9DTElFTlRfSURcIiwgY2hhaW46IFwiUG9seWdvblwifSlcbiAgICogdHJ5IHtcbiAgICogICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcmR3ZWJFbWJlZGRlZFdhbGxldC5hdXRoLmxvZ2luV2l0aE1vZGFsKCk7XG4gICAqICAgLy8gdXNlciBpcyBub3cgbG9nZ2VkIGluXG4gICAqIH0gY2F0Y2ggKGUpIHtcbiAgICogICAvLyBVc2VyIGNsb3NlZCBtb2RhbCBvciBzb21ldGhpbmcgZWxzZSB3ZW50IHdyb25nIGR1cmluZyB0aGUgYXV0aGVudGljYXRpb24gcHJvY2Vzc1xuICAgKiAgIGNvbnNvbGUuZXJyb3IoZSlcbiAgICogfVxuICAgKiBgYGBcbiAgICpcbiAgICogQHJldHVybnMgYHt7dXNlcjogSW5pdGlhbGl6ZWRVc2VyfX1gIEFuIEluaXRpYWxpemVkVXNlciBvYmplY3QuIFNlZSB7QGxpbmsgRW1iZWRkZWRXYWxsZXRTZGsuZ2V0VXNlcn0gZm9yIG1vcmVcbiAgICovXG4gIGFzeW5jIGxvZ2luV2l0aE1vZGFsKCkge1xuICAgIGF3YWl0IHRoaXMucHJlTG9naW4oKTtcbiAgICByZXR1cm4gdGhpcy5CYXNlTG9naW4ubG9naW5XaXRoTW9kYWwoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIHRvIGxvZyB0aGUgdXNlciBpbnRvIHRoZWlyIHRoaXJkd2ViIHdhbGxldCB1c2luZyBlbWFpbCBPVFBcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiAgLy8gQmFzaWMgRmxvd1xuICAgKiAgY29uc3QgdGhpcmR3ZWJFbWJlZGRlZFdhbGxldCA9IG5ldyBFbWJlZGRlZFdhbGxldFNkayh7Y2xpZW50SWQ6IFwiXCIsIGNoYWluOiBcIlBvbHlnb25cIn0pO1xuICAgKiAgdHJ5IHtcbiAgICogICAgLy8gcHJvbXB0cyB1c2VyIHRvIGVudGVyIHRoZSBjb2RlIHRoZXkgcmVjZWl2ZWRcbiAgICogICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXJkd2ViRW1iZWRkZWRXYWxsZXQuYXV0aC5sb2dpbldpdGhUaGlyZHdlYkVtYWlsT3RwKHsgZW1haWwgOiBcInlvdUBleGFtcGxlLmNvbVwiIH0pO1xuICAgKiAgICAvLyB1c2VyIGlzIG5vdyBsb2dnZWQgaW5cbiAgICogIH0gY2F0Y2ggKGUpIHtcbiAgICogICAgLy8gVXNlciBjbG9zZWQgdGhlIE9UUCBtb2RhbCBvciBzb21ldGhpbmcgZWxzZSB3ZW50IHdyb25nIGR1cmluZyB0aGUgYXV0aGVudGljYXRpb24gcHJvY2Vzc1xuICAgKiAgICBjb25zb2xlLmVycm9yKGUpXG4gICAqICB9XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gYXJncyAtIGFyZ3MuZW1haWw6IFdlIHdpbGwgc2VuZCB0aGUgZW1haWwgYW4gT1RQIHRoYXQgbmVlZHMgdG8gYmUgZW50ZXJlZCBpbiBvcmRlciBmb3IgdGhlbSB0byBiZSBsb2dnZWQgaW4uXG4gICAqIEByZXR1cm5zIGB7e3VzZXI6IEluaXRpYWxpemVkVXNlcn19YCBBbiBJbml0aWFsaXplZFVzZXIgb2JqZWN0LiBTZWUge0BsaW5rIEVtYmVkZGVkV2FsbGV0U2RrLmdldFVzZXJ9IGZvciBtb3JlXG4gICAqL1xuICBhc3luYyBsb2dpbldpdGhFbWFpbE90cChhcmdzKSB7XG4gICAgcmV0dXJuIHRoaXMuQmFzZUxvZ2luLmxvZ2luV2l0aEVtYWlsT3RwKGFyZ3MpO1xuICB9XG4gIGFzeW5jIGxvZ2luV2l0aEN1c3RvbUp3dChhcmdzKSB7XG4gICAgcmV0dXJuIHRoaXMuQmFzZUxvZ2luLmxvZ2luV2l0aEN1c3RvbUp3dChhcmdzKTtcbiAgfVxuICBhc3luYyBsb2dpbldpdGhPYXV0aChhcmdzKSB7XG4gICAgcmV0dXJuIHRoaXMuQmFzZUxvZ2luLmxvZ2luV2l0aE9hdXRoKGFyZ3MpO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgaGVhZGxlc3Mgd2F5IHRvIHNlbmQgdGhlIHVzZXJzIGF0IHRoZSBwYXNzZWQgZW1haWwgYW4gT1RQIGNvZGUuXG4gICAqIFlvdSBuZWVkIHRvIHRoZW4gY2FsbCB7QGxpbmsgQXV0aC52ZXJpZnlFbWFpbExvZ2luT3RwfSBpbiBvcmRlciB0byBjb21wbGV0ZSB0aGUgbG9naW4gcHJvY2Vzc1xuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqICBjb25zdCB0aGlyZHdlYkVtYmVkZGVkV2FsbGV0ID0gbmV3IEVtYmVkZGVkV2FsbGV0U2RrKHtjbGllbnRJZDogXCJcIiwgY2hhaW46IFwiUG9seWdvblwifSk7XG4gICAqICAvLyBzZW5kcyB1c2VyIGFuIE9UUCBjb2RlXG4gICAqIHRyeSB7XG4gICAqICAgIGF3YWl0IHRoaXJkd2ViRW1iZWRkZWRXYWxsZXQuYXV0aC5zZW5kRW1haWxMb2dpbk90cCh7IGVtYWlsIDogXCJ5b3VAZXhhbXBsZS5jb21cIiB9KTtcbiAgICogfSBjYXRjaChlKSB7XG4gICAqICAgIC8vIEVycm9yIFNlbmRpbmcgdXNlcidzIGVtYWlsIGFuIE9UUCBjb2RlXG4gICAqICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAqIH1cbiAgICpcbiAgICogLy8gVGhlbiB3aGVuIHlvdXIgdXNlciBpcyByZWFkeSB0byB2ZXJpZnkgdGhlaXIgT1RQXG4gICAqIHRyeSB7XG4gICAqICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB0aGlyZHdlYkVtYmVkZGVkV2FsbGV0LmF1dGgudmVyaWZ5RW1haWxMb2dpbk90cCh7IGVtYWlsOiBcInlvdUBleGFtcGxlLmNvbVwiLCBvdHA6IFwiNi1ESUdJVF9DT0RFX0hFUkVcIiB9KTtcbiAgICogfSBjYXRjaChlKSB7XG4gICAqICAgIC8vIEVycm9yIHZlcmlmeWluZyB0aGUgT1RQIGNvZGVcbiAgICogICAgY29uc29sZS5lcnJvcihlKVxuICAgKiB9XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gcGFyYW0wIC0gcGFyYW0wLmVtYWlsIFdlIHdpbGwgc2VuZCB0aGUgZW1haWwgYW4gT1RQIHRoYXQgbmVlZHMgdG8gYmUgZW50ZXJlZCBpbiBvcmRlciBmb3IgdGhlbSB0byBiZSBsb2dnZWQgaW4uXG4gICAqIEByZXR1cm5zIGB7eyBpc05ld1VzZXI6IGJvb2xlYW4gfX1gIElzTmV3VXNlciBpbmRpY2F0ZXMgaWYgdGhlIHVzZXIgaXMgYSBuZXcgdXNlciB0byB5b3VyIHBsYXRmb3JtXG4gICAqL1xuICBhc3luYyBzZW5kRW1haWxMb2dpbk90cChfcmVmMykge1xuICAgIGxldCB7XG4gICAgICBlbWFpbFxuICAgIH0gPSBfcmVmMztcbiAgICByZXR1cm4gdGhpcy5CYXNlTG9naW4uc2VuZEVtYWlsTG9naW5PdHAoe1xuICAgICAgZW1haWxcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIHRvIHZlcmlmeSB0aGUgb3RwIHRoYXQgdGhlIHVzZXIgcmVjZWl2ZXMgZnJvbSB0aGlyZHdlYlxuICAgKlxuICAgKiBTZWUge0BsaW5rIEF1dGguc2VuZEVtYWlsTG9naW5PdHB9IGZvciBob3cgdGhlIGhlYWRsZXNzIGNhbGwgZmxvdyBsb29rcyBsaWtlLiBTaW1wbHkgc3dhcCBvdXQgdGhlIGNhbGxzIHRvIGBsb2dpbldpdGhUaGlyZHdlYkVtYWlsT3RwYCB3aXRoIGB2ZXJpZnlUaGlyZHdlYkVtYWlsTG9naW5PdHBgXG4gICAqXG4gICAqIEBwYXJhbSBhcmdzIC0gcHJvcHMuZW1haWwgV2Ugd2lsbCBzZW5kIHRoZSBlbWFpbCBhbiBPVFAgdGhhdCBuZWVkcyB0byBiZSBlbnRlcmVkIGluIG9yZGVyIGZvciB0aGVtIHRvIGJlIGxvZ2dlZCBpbi5cbiAgICogcHJvcHMub3RwIFRoZSBjb2RlIHRoYXQgdGhlIHVzZXIgcmVjZWl2ZWQgaW4gdGhlaXIgZW1haWxcbiAgICogQHJldHVybnMgYHt7dXNlcjogSW5pdGlhbGl6ZWRVc2VyfX1gIEFuIEluaXRpYWxpemVkVXNlciBvYmplY3QgY29udGFpbmluZyB0aGUgdXNlcidzIHN0YXR1cywgd2FsbGV0LCBhdXRoRGV0YWlscywgYW5kIG1vcmVcbiAgICovXG4gIGFzeW5jIHZlcmlmeUVtYWlsTG9naW5PdHAoYXJncykge1xuICAgIHJldHVybiB0aGlzLkJhc2VMb2dpbi52ZXJpZnlFbWFpbExvZ2luT3RwKGFyZ3MpO1xuICB9XG5cbiAgLyoqXG4gICAqIExvZ3MgYW55IGV4aXN0aW5nIHVzZXIgb3V0IG9mIHRoZWlyIHdhbGxldC5cbiAgICogQHJldHVybnMgYHt7c3VjY2VzczogYm9vbGVhbn19YCB0cnVlIGlmIGEgdXNlciBpcyBzdWNjZXNzZnVsbHkgbG9nZ2VkIG91dC4gZmFsc2UgaWYgdGhlcmUncyBubyB1c2VyIGN1cnJlbnRseSBsb2dnZWQgaW4uXG4gICAqL1xuICBhc3luYyBsb2dvdXQoKSB7XG4gICAgY29uc3Qge1xuICAgICAgc3VjY2Vzc1xuICAgIH0gPSBhd2FpdCB0aGlzLkF1dGhRdWVyaWVyLmNhbGwoe1xuICAgICAgcHJvY2VkdXJlTmFtZTogXCJsb2dvdXRcIixcbiAgICAgIHBhcmFtczogdW5kZWZpbmVkXG4gICAgfSk7XG4gICAgY29uc3QgaXNSZW1vdmVBdXRoQ29va2llID0gYXdhaXQgdGhpcy5sb2NhbFN0b3JhZ2UucmVtb3ZlQXV0aENvb2tpZSgpO1xuICAgIGNvbnN0IGlzUmVtb3ZlVXNlcklkID0gYXdhaXQgdGhpcy5sb2NhbFN0b3JhZ2UucmVtb3ZlV2FsbGV0VXNlcklkKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHN1Y2Nlc3MgfHwgaXNSZW1vdmVBdXRoQ29va2llIHx8IGlzUmVtb3ZlVXNlcklkXG4gICAgfTtcbiAgfVxufVxuXG5jbGFzcyBFdGhlcnNTaWduZXIgZXh0ZW5kcyBTaWduZXIge1xuICBjb25zdHJ1Y3RvcihfcmVmKSB7XG4gICAgbGV0IHtcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgY2xpZW50SWQsXG4gICAgICBxdWVyaWVyXG4gICAgfSA9IF9yZWY7XG4gICAgc3VwZXIoKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJERUZBVUxUX0VUSEVSRVVNX0NIQUlOX0lEXCIsIDUpO1xuICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDtcbiAgICB0aGlzLnF1ZXJpZXIgPSBxdWVyaWVyO1xuICAgIC8vIHdlIHRyeSB0byBleHRyYWN0IGEgdXJsIGlmIHBvc3NpYmxlXG4gICAgdGhpcy5lbmRwb2ludCA9IHByb3ZpZGVyLmNvbm5lY3Rpb24/LnVybDtcbiAgICBkZWZpbmVSZWFkT25seSh0aGlzLCBcInByb3ZpZGVyXCIsIHByb3ZpZGVyKTtcbiAgfVxuICBhc3luYyBnZXRBZGRyZXNzKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIGFkZHJlc3NcbiAgICB9ID0gYXdhaXQgdGhpcy5xdWVyaWVyLmNhbGwoe1xuICAgICAgcHJvY2VkdXJlTmFtZTogXCJnZXRBZGRyZXNzXCIsXG4gICAgICBwYXJhbXM6IHVuZGVmaW5lZFxuICAgIH0pO1xuICAgIHJldHVybiBhZGRyZXNzO1xuICB9XG4gIGFzeW5jIHNpZ25NZXNzYWdlKG1lc3NhZ2UpIHtcbiAgICBjb25zdCB7XG4gICAgICBzaWduZWRNZXNzYWdlXG4gICAgfSA9IGF3YWl0IHRoaXMucXVlcmllci5jYWxsKHtcbiAgICAgIHByb2NlZHVyZU5hbWU6IFwic2lnbk1lc3NhZ2VcIixcbiAgICAgIHBhcmFtczoge1xuICAgICAgICBtZXNzYWdlLFxuICAgICAgICBjaGFpbklkOiAoYXdhaXQgdGhpcy5wcm92aWRlcj8uZ2V0TmV0d29yaygpKT8uY2hhaW5JZCA/PyB0aGlzLkRFRkFVTFRfRVRIRVJFVU1fQ0hBSU5fSUQsXG4gICAgICAgIHJwY0VuZHBvaW50OiB0aGlzLmVuZHBvaW50XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHNpZ25lZE1lc3NhZ2U7XG4gIH1cbiAgYXN5bmMgc2lnblRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKSB7XG4gICAgY29uc3Qge1xuICAgICAgc2lnbmVkVHJhbnNhY3Rpb25cbiAgICB9ID0gYXdhaXQgdGhpcy5xdWVyaWVyLmNhbGwoe1xuICAgICAgcHJvY2VkdXJlTmFtZTogXCJzaWduVHJhbnNhY3Rpb25cIixcbiAgICAgIHBhcmFtczoge1xuICAgICAgICB0cmFuc2FjdGlvbixcbiAgICAgICAgY2hhaW5JZDogKGF3YWl0IHRoaXMucHJvdmlkZXI/LmdldE5ldHdvcmsoKSk/LmNoYWluSWQgPz8gdGhpcy5ERUZBVUxUX0VUSEVSRVVNX0NIQUlOX0lELFxuICAgICAgICBycGNFbmRwb2ludDogdGhpcy5lbmRwb2ludFxuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBzaWduZWRUcmFuc2FjdGlvbjtcbiAgfVxuICBhc3luYyBfc2lnblR5cGVkRGF0YShkb21haW4sIHR5cGVzLCBtZXNzYWdlKSB7XG4gICAgY29uc3Qge1xuICAgICAgc2lnbmVkVHlwZWREYXRhXG4gICAgfSA9IGF3YWl0IHRoaXMucXVlcmllci5jYWxsKHtcbiAgICAgIHByb2NlZHVyZU5hbWU6IFwic2lnblR5cGVkRGF0YVY0XCIsXG4gICAgICBwYXJhbXM6IHtcbiAgICAgICAgZG9tYWluLFxuICAgICAgICB0eXBlcyxcbiAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgY2hhaW5JZDogKGF3YWl0IHRoaXMucHJvdmlkZXI/LmdldE5ldHdvcmsoKSk/LmNoYWluSWQgPz8gdGhpcy5ERUZBVUxUX0VUSEVSRVVNX0NIQUlOX0lELFxuICAgICAgICBycGNFbmRwb2ludDogdGhpcy5lbmRwb2ludFxuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBzaWduZWRUeXBlZERhdGE7XG4gIH1cbiAgY29ubmVjdChwcm92aWRlcikge1xuICAgIHJldHVybiBuZXcgRXRoZXJzU2lnbmVyKHtcbiAgICAgIGNsaWVudElkOiB0aGlzLmNsaWVudElkLFxuICAgICAgcHJvdmlkZXIsXG4gICAgICBxdWVyaWVyOiB0aGlzLnF1ZXJpZXJcbiAgICB9KTtcbiAgfVxufVxuXG5jbGFzcyBFbWJlZGRlZFdhbGxldCB7XG4gIC8qKlxuICAgKiBOb3QgbWVhbnQgdG8gYmUgaW5pdGlhbGl6ZWQgZGlyZWN0bHkuIENhbGwge0BsaW5rIGluaXRpYWxpemVVc2VyfSB0byBnZXQgYW4gaW5zdGFuY2VcbiAgICovXG4gIGNvbnN0cnVjdG9yKF9yZWYpIHtcbiAgICBsZXQge1xuICAgICAgY2xpZW50SWQsXG4gICAgICBjaGFpbixcbiAgICAgIHF1ZXJpZXJcbiAgICB9ID0gX3JlZjtcbiAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XG4gICAgdGhpcy5jaGFpbiA9IGNoYWluO1xuICAgIHRoaXMud2FsbGV0TWFuYWdlclF1ZXJpZXIgPSBxdWVyaWVyO1xuICAgIHRoaXMubG9jYWxTdG9yYWdlID0gbmV3IExvY2FsU3RvcmFnZSh7XG4gICAgICBjbGllbnRJZFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBpbnRlcm5hbFxuICAgKiBVc2VkIHRvIHNldC11cCB0aGUgdXNlciBkZXZpY2UgaW4gdGhlIGNhc2UgdGhhdCB0aGV5IGFyZSB1c2luZyBpbmNvZ25pdG9cbiAgICogQHJldHVybnMgYHt3YWxsZXRBZGRyZXNzIDogc3RyaW5nIH1gIFRoZSB1c2VyJ3Mgd2FsbGV0IGRldGFpbHNcbiAgICovXG4gIGFzeW5jIHBvc3RXYWxsZXRTZXRVcChfcmVmMikge1xuICAgIGxldCB7XG4gICAgICBkZXZpY2VTaGFyZVN0b3JlZCxcbiAgICAgIHdhbGxldEFkZHJlc3MsXG4gICAgICBpc0lmcmFtZVN0b3JhZ2VFbmFibGVkLFxuICAgICAgd2FsbGV0VXNlcklkXG4gICAgfSA9IF9yZWYyO1xuICAgIGlmICghaXNJZnJhbWVTdG9yYWdlRW5hYmxlZCkge1xuICAgICAgYXdhaXQgdGhpcy5sb2NhbFN0b3JhZ2Uuc2F2ZURldmljZVNoYXJlKGRldmljZVNoYXJlU3RvcmVkLCB3YWxsZXRVc2VySWQpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgd2FsbGV0QWRkcmVzc1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQGludGVybmFsXG4gICAqIEdldHMgdGhlIHZhcmlvdXMgc3RhdHVzIHN0YXRlcyBvZiB0aGUgdXNlclxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqICBjb25zdCB1c2VyU3RhdHVzID0gYXdhaXQgUGFwZXIuZ2V0VXNlcldhbGxldFN0YXR1cygpO1xuICAgKiAgc3dpdGNoICh1c2VyU3RhdHVzLnN0YXR1cykge1xuICAgKiAgY2FzZSBVc2VyV2FsbGV0U3RhdHVzLkxPR0dFRF9PVVQ6IHtcbiAgICogICAgLy8gVXNlciBpcyBsb2dnZWQgb3V0LCBjYWxsIG9uZSBvZiB0aGUgYXV0aCBtZXRob2RzIG9uIFBhcGVyLmF1dGggdG8gYXV0aGVudGljYXRlIHRoZSB1c2VyXG4gICAqICAgIGJyZWFrO1xuICAgKiAgfVxuICAgKiAgY2FzZSBVc2VyV2FsbGV0U3RhdHVzLkxPR0dFRF9JTl9XQUxMRVRfVU5JTklUSUFMSVpFRDoge1xuICAgKiAgICAvLyBVc2VyIGlzIGxvZ2dlZCBpbiwgYnV0IGRvZXMgbm90IGhhdmUgYSB3YWxsZXQgYXNzb2NpYXRlZCB3aXRoIGl0XG4gICAqICAgIC8vIHlvdSBhbHNvIGhhdmUgYWNjZXNzIHRvIHRoZSB1c2VyJ3MgZGV0YWlsc1xuICAgKiAgICB1c2VyU3RhdHVzLnVzZXIuYXV0aERldGFpbHM7XG4gICAqICAgIGJyZWFrO1xuICAgKiAgfVxuICAgKiAgY2FzZSBVc2VyV2FsbGV0U3RhdHVzLkxPR0dFRF9JTl9ORVdfREVWSUNFOiB7XG4gICAqICAgIC8vIFVzZXIgaXMgbG9nZ2VkIGluIGFuZCBjcmVhdGVkIGEgd2FsbGV0IGFscmVhZHksIGJ1dCBpcyBtaXNzaW5nIHRoZSBkZXZpY2Ugc2hhcmRcbiAgICogICAgLy8gWW91IGhhdmUgYWNjZXNzIHRvOlxuICAgKiAgICB1c2VyU3RhdHVzLnVzZXIuYXV0aERldGFpbHM7XG4gICAqICAgIHVzZXJTdGF0dXMudXNlci53YWxsZXRBZGRyZXNzO1xuICAgKiAgICBicmVhaztcbiAgICogIH1cbiAgICogIGNhc2UgVXNlcldhbGxldFN0YXR1cy5MT0dHRURfSU5fV0FMTEVUX0lOSVRJQUxJWkVEOiB7XG4gICAqICAgIC8vIHVzZXIgaXMgbG9nZ2VkIGluIGFuZCB3YWxsZXQgaXMgYWxsIHNldCB1cC5cbiAgICogICAgLy8gWW91IGhhdmUgYWNjZXNzIHRvOlxuICAgKiAgICB1c2VyU3RhdHVzLnVzZXIuYXV0aERldGFpbHM7XG4gICAqICAgIHVzZXJTdGF0dXMudXNlci53YWxsZXRBZGRyZXNzO1xuICAgKiAgICB1c2VyU3RhdHVzLnVzZXIud2FsbGV0O1xuICAgKiAgICBicmVhaztcbiAgICogIH1cbiAgICp9XG4gICAqYGBgXG4gICAqIEByZXR1cm5zIGB7R2V0VXNlcldhbGxldFN0YXR1c0ZuUmV0dXJuVHlwZX1gIGFuIG9iamVjdCB0byBjb250YWluaW5nIHZhcmlvdXMgaW5mb3JtYXRpb24gb24gdGhlIHVzZXIgc3RhdHVzZXNcbiAgICovXG4gIGFzeW5jIGdldFVzZXJXYWxsZXRTdGF0dXMoKSB7XG4gICAgY29uc3QgdXNlclN0YXR1cyA9IGF3YWl0IHRoaXMud2FsbGV0TWFuYWdlclF1ZXJpZXIuY2FsbCh7XG4gICAgICBwcm9jZWR1cmVOYW1lOiBcImdldFVzZXJTdGF0dXNcIixcbiAgICAgIHBhcmFtczogdW5kZWZpbmVkXG4gICAgfSk7XG4gICAgaWYgKHVzZXJTdGF0dXMuc3RhdHVzID09PSBVc2VyV2FsbGV0U3RhdHVzLkxPR0dFRF9JTl9XQUxMRVRfSU5JVElBTElaRUQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXR1czogVXNlcldhbGxldFN0YXR1cy5MT0dHRURfSU5fV0FMTEVUX0lOSVRJQUxJWkVELFxuICAgICAgICAuLi51c2VyU3RhdHVzLnVzZXIsXG4gICAgICAgIHdhbGxldDogdGhpc1xuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHVzZXJTdGF0dXMuc3RhdHVzID09PSBVc2VyV2FsbGV0U3RhdHVzLkxPR0dFRF9JTl9ORVdfREVWSUNFKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGF0dXM6IFVzZXJXYWxsZXRTdGF0dXMuTE9HR0VEX0lOX1dBTExFVF9VTklOSVRJQUxJWkVELFxuICAgICAgICAuLi51c2VyU3RhdHVzLnVzZXJcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmICh1c2VyU3RhdHVzLnN0YXR1cyA9PT0gVXNlcldhbGxldFN0YXR1cy5MT0dHRURfSU5fV0FMTEVUX1VOSU5JVElBTElaRUQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0YXR1czogVXNlcldhbGxldFN0YXR1cy5MT0dHRURfSU5fV0FMTEVUX1VOSU5JVElBTElaRUQsXG4gICAgICAgIC4uLnVzZXJTdGF0dXMudXNlclxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gTG9nZ2VkIG91dFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHVzOiB1c2VyU3RhdHVzLnN0YXR1c1xuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU3dpdGNoZXMgdGhlIGNoYWluIHRoYXQgdGhlIHVzZXIgd2FsbGV0IGlzIGN1cnJlbnRseSBvbi5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHlwZXNjcmlwdFxuICAgKiAvLyB1c2VyIHdhbGxldCB3aWxsIGJlIHNldCB0byBQb2x5Z29uXG4gICAqIGNvbnN0IFBhcGVyID0gbmV3IFRoaXJkd2ViRW1iZWRkZWRXYWxsZXRTZGsoe2NsaWVudElkOiBcIlwiLCBjaGFpbjogXCJQb2x5Z29uXCJ9KTtcbiAgICogY29uc3QgdXNlciA9IGF3YWl0IFBhcGVyLmluaXRpYWxpemVVc2VyKCk7XG4gICAqIC8vIFN3aXRjaCB0aGUgdXNlciB3YWxsZXQgdG8gTXVtYmFpXG4gICAqIGF3YWl0IHVzZXIud2FsbGV0LnNldENoYWluKHsgY2hhaW46IFwiTXVtYmFpXCIgfSk7XG4gICAqIGBgYFxuICAgKiBAcGFyYW0gcGFyYW0wIC0gVGhlIGNoYWluIHRoYXQgd2UgYXJlIGNoYW5naW5nIHRoZSB1c2VyIHdhbGxldCB0b29cbiAgICovXG4gIGFzeW5jIHNldENoYWluKF9yZWYzKSB7XG4gICAgbGV0IHtcbiAgICAgIGNoYWluXG4gICAgfSA9IF9yZWYzO1xuICAgIHRoaXMuY2hhaW4gPSBjaGFpbjtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIEV0aGVycy5KcyBjb21wYXRpYmxlIHNpZ25lciB0aGF0IHlvdSBjYW4gdXNlIGluIGNvbmp1bmN0aW9uIHdpdGggdGhlIHJlc3Qgb2YgZEFwcFxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IFBhcGVyID0gbmV3IFRoaXJkd2ViRW1iZWRkZWRXYWxsZXRTZGsoe2NsaWVudElkOiBcIlwiLCBjaGFpbjogXCJQb2x5Z29uXCJ9KTtcbiAgICogY29uc3QgdXNlciA9IGF3YWl0IFBhcGVyLmdldFVzZXIoKTtcbiAgICogaWYgKHVzZXIuc3RhdHVzID09PSBVc2VyU3RhdHVzLkxPR0dFRF9JTl9XQUxMRVRfSU5JVElBTElaRUQpIHtcbiAgICogICAgLy8gcmV0dXJucyBhIHNpZ25lciBvbiB0aGUgUG9seWdvbiBtYWlubmV0XG4gICAqICAgIGNvbnN0IHNpZ25lciA9IGF3YWl0IHVzZXIuZ2V0RXRoZXJzSnNTaWduZXIoKTtcbiAgICogICAgLy8gcmV0dXJucyBhIHNpZ25lciBvbiB0aGUgc3BlY2lmaWVkIFJQQyBlbmRwb2ludHNcbiAgICogICAgY29uc3Qgc2lnbmVyID0gYXdhaXQgdXNlci5nZXRFdGhlcnNKc1NpZ25lcih7cnBjRW5kcG9pbnQ6IFwiaHR0cHM6Ly9ldGgtcnBjLmdhdGV3YXkucG9rdC5uZXR3b3JrXCJ9KTtcbiAgICogfVxuICAgKiBgYGBcbiAgICogQHBhcmFtIG5ldHdvcmsgLSBvYmplY3Qgd2l0aCB0aGUgcnBjIHVybCB3aGVyZSBjYWxscyB3aWxsIGJlIHJvdXRlZCB0aHJvdWdoXG4gICAqIEB0aHJvd3MgSWYgYXR0ZW1wdGluZyB0byBjYWxsIHRoZSBmdW5jdGlvbiB3aXRob3V0IHRoZSB1c2VyIHdhbGxldCBpbml0aWFsaXplIG9uIHRoZWlyIGN1cnJlbnQgZGV2aWNlLiBUaGlzIHNob3VsZCBuZXZlciBoYXBwZW4gaWYgY2FsbCB7QGxpbmsgVGhpcmR3ZWJFbWJlZGRlZFdhbGxldFNkay5pbml0aWFsaXplVXNlcn0gYmVmb3JlIGFjY2Vzc2luZyB0aGlzIGZ1bmN0aW9uXG4gICAqIEByZXR1cm5zIEEgc2lnbmVyIHRoYXQgaXMgY29tcGF0aWJsZSB3aXRoIEV0aGVyLmpzLiBEZWZhdWx0cyB0byB0aGUgcHVibGljIHJwYyBvbiB0aGUgY2hhaW4gc3BlY2lmaWVkIHdoZW4gaW5pdGlhbGl6aW5nIHRoZSB7QGxpbmsgVGhpcmR3ZWJFbWJlZGRlZFdhbGxldFNka30gaW5zdGFuY2VcbiAgICovXG4gIGFzeW5jIGdldEV0aGVyc0pzU2lnbmVyKG5ldHdvcmspIHtcbiAgICBjb25zdCBzaWduZXIgPSBuZXcgRXRoZXJzU2lnbmVyKHtcbiAgICAgIGNsaWVudElkOiB0aGlzLmNsaWVudElkLFxuICAgICAgcHJvdmlkZXI6IGdldERlZmF1bHRQcm92aWRlcihuZXR3b3JrPy5ycGNFbmRwb2ludCA/PyBDaGFpblRvUHVibGljUnBjW3RoaXMuY2hhaW5dKSxcbiAgICAgIHF1ZXJpZXI6IHRoaXMud2FsbGV0TWFuYWdlclF1ZXJpZXJcbiAgICB9KTtcbiAgICByZXR1cm4gc2lnbmVyO1xuICB9XG59XG5cbmNsYXNzIEVtYmVkZGVkV2FsbGV0U2RrIHtcbiAgLyoqXG4gICAqIFVzZWQgdG8gbWFuYWdlIHRoZSBBdXRoIHN0YXRlIG9mIHRoZSB1c2VyLlxuICAgKi9cblxuICBpc0NsaWVudElkTGVnYWN5UGFwZXIoY2xpZW50SWQpIHtcbiAgICBpZiAoY2xpZW50SWQuaW5kZXhPZihcIi1cIikgPiAwICYmIGNsaWVudElkLmxlbmd0aCA9PT0gMzYpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEBleGFtcGxlXG4gICAqIGBjb25zdCB0aGlyZHdlYkVtYmVkZGVkV2FsbGV0ID0gbmV3IEVtYmVkZGVkV2FsbGV0U2RrKHsgY2xpZW50SWQ6IFwiXCIsIGNoYWluOiBcIkdvZXJsaVwiIH0pO2BcbiAgICogQHBhcmFtIHBhcmFtMCAtIEVtYmVkZGVkV2FsbGV0Q29uc3RydWN0b3JUeXBlXG4gICAqL1xuICBjb25zdHJ1Y3RvcihfcmVmKSB7XG4gICAgbGV0IHtcbiAgICAgIGNsaWVudElkLFxuICAgICAgY2hhaW4sXG4gICAgICBzdHlsZXMsXG4gICAgICBvbkF1dGhTdWNjZXNzXG4gICAgfSA9IF9yZWY7XG4gICAgaWYgKHRoaXMuaXNDbGllbnRJZExlZ2FjeVBhcGVyKGNsaWVudElkKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IGFyZSB1c2luZyBhIGxlZ2FjeSBjbGllbnRJZC4gUGxlYXNlIHVzZSB0aGUgY2xpZW50SWQgZm91bmQgb24gdGhlIHRoaXJkd2ViIGRhc2hib2FyZCBzZXR0aW5ncyBwYWdlXCIpO1xuICAgIH1cbiAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XG4gICAgdGhpcy5xdWVyaWVyID0gbmV3IEVtYmVkZGVkV2FsbGV0SWZyYW1lQ29tbXVuaWNhdG9yKHtcbiAgICAgIGNsaWVudElkLFxuICAgICAgY3VzdG9taXphdGlvbk9wdGlvbnM6IHN0eWxlc1xuICAgIH0pO1xuICAgIHRoaXMud2FsbGV0ID0gbmV3IEVtYmVkZGVkV2FsbGV0KHtcbiAgICAgIGNsaWVudElkLFxuICAgICAgY2hhaW4sXG4gICAgICBxdWVyaWVyOiB0aGlzLnF1ZXJpZXJcbiAgICB9KTtcbiAgICB0aGlzLmF1dGggPSBuZXcgQXV0aCh7XG4gICAgICBjbGllbnRJZCxcbiAgICAgIHF1ZXJpZXI6IHRoaXMucXVlcmllcixcbiAgICAgIG9uQXV0aFN1Y2Nlc3M6IGFzeW5jIGF1dGhSZXN1bHQgPT4ge1xuICAgICAgICBvbkF1dGhTdWNjZXNzPy4oYXV0aFJlc3VsdCk7XG4gICAgICAgIGF3YWl0IHRoaXMud2FsbGV0LnBvc3RXYWxsZXRTZXRVcCh7XG4gICAgICAgICAgLi4uYXV0aFJlc3VsdC53YWxsZXREZXRhaWxzLFxuICAgICAgICAgIHdhbGxldFVzZXJJZDogYXV0aFJlc3VsdC5zdG9yZWRUb2tlbi5hdXRoRGV0YWlscy51c2VyV2FsbGV0SWRcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMucXVlcmllci5jYWxsKHtcbiAgICAgICAgICBwcm9jZWR1cmVOYW1lOiBcImluaXRJZnJhbWVcIixcbiAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgIGRldmljZVNoYXJlU3RvcmVkOiBhdXRoUmVzdWx0LndhbGxldERldGFpbHMuZGV2aWNlU2hhcmVTdG9yZWQsXG4gICAgICAgICAgICBjbGllbnRJZDogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICAgIHdhbGxldFVzZXJJZDogYXV0aFJlc3VsdC5zdG9yZWRUb2tlbi5hdXRoRGV0YWlscy51c2VyV2FsbGV0SWQsXG4gICAgICAgICAgICBhdXRoQ29va2llOiBhdXRoUmVzdWx0LnN0b3JlZFRva2VuLmNvb2tpZVN0cmluZ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgc3RhdHVzOiBVc2VyV2FsbGV0U3RhdHVzLkxPR0dFRF9JTl9XQUxMRVRfSU5JVElBTElaRUQsXG4gICAgICAgICAgICBhdXRoRGV0YWlsczogYXV0aFJlc3VsdC5zdG9yZWRUb2tlbi5hdXRoRGV0YWlscyxcbiAgICAgICAgICAgIHdhbGxldDogdGhpcy53YWxsZXQsXG4gICAgICAgICAgICB3YWxsZXRBZGRyZXNzOiBhdXRoUmVzdWx0LndhbGxldERldGFpbHMud2FsbGV0QWRkcmVzc1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSB1c3IgaWYgdGhleSBhcmUgbG9nZ2VkIGluXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGpzXG4gICAqICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcmR3ZWJFbWJlZGRlZFdhbGxldC5nZXRVc2VyKCk7XG4gICAqICBzd2l0Y2ggKHVzZXIuc3RhdHVzKSB7XG4gICAqICAgICBjYXNlIFVzZXJXYWxsZXRTdGF0dXMuTE9HR0VEX09VVDoge1xuICAgKiAgICAgICAvLyBVc2VyIGlzIGxvZ2dlZCBvdXQsIGNhbGwgb25lIG9mIHRoZSBhdXRoIG1ldGhvZHMgb24gdGhpcmR3ZWJFbWJlZGRlZFdhbGxldC5hdXRoIHRvIGF1dGhlbnRpY2F0ZSB0aGUgdXNlclxuICAgKiAgICAgICBicmVhaztcbiAgICogICAgIH1cbiAgICogICAgIGNhc2UgVXNlcldhbGxldFN0YXR1cy5MT0dHRURfSU5fV0FMTEVUX0lOSVRJQUxJWkVEOiB7XG4gICAqICAgICAgIC8vIHVzZXIgaXMgbG9nZ2VkIGluIGFuZCB3YWxsZXQgaXMgYWxsIHNldCB1cC5cbiAgICogICAgICAgLy8gWW91IGhhdmUgYWNjZXNzIHRvOlxuICAgKiAgICAgICB1c2VyLnN0YXR1cztcbiAgICogICAgICAgdXNlci5hdXRoRGV0YWlscztcbiAgICogICAgICAgdXNlci53YWxsZXRBZGRyZXNzO1xuICAgKiAgICAgICB1c2VyLndhbGxldDtcbiAgICogICAgICAgYnJlYWs7XG4gICAqICAgICB9XG4gICAqIH1cbiAgICogYGBgXG4gICAqIEByZXR1cm5zIEdldFVzZXIgLSBhbiBvYmplY3QgdG8gY29udGFpbmluZyB2YXJpb3VzIGluZm9ybWF0aW9uIG9uIHRoZSB1c2VyIHN0YXR1c2VzXG4gICAqL1xuICBhc3luYyBnZXRVc2VyKCkge1xuICAgIHJldHVybiB0aGlzLndhbGxldC5nZXRVc2VyV2FsbGV0U3RhdHVzKCk7XG4gIH1cbn1cblxuZXhwb3J0IHsgQVVUSF9UT0tFTl9MT0NBTF9TVE9SQUdFX05BTUUgYXMgQSwgREVWSUNFX1NIQVJFX0xPQ0FMX1NUT1JBR0VfTkFNRSBhcyBELCBFbWJlZGRlZFdhbGxldFNkayBhcyBFLCBSZWNvdmVyeVNoYXJlTWFuYWdlbWVudCBhcyBSLCBVc2VyV2FsbGV0U3RhdHVzIGFzIFUsIFdBTExFVF9VU0VSX0RFVEFJTFNfTE9DQUxfU1RPUkFHRV9OQU1FIGFzIFcsIERFVklDRV9TSEFSRV9MT0NBTF9TVE9SQUdFX05BTUVfREVQUkVDQVRFRCBhcyBhLCBXQUxMRVRfVVNFUl9JRF9MT0NBTF9TVE9SQUdFX05BTUUgYXMgYiwgQXV0aFByb3ZpZGVyIGFzIGMgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/embedded-wallet-30be9c09.browser.esm.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/normalizeChainId-e4cc0175.browser.esm.js":
/*!***************************************************************************************************************************!*\
  !*** ./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/normalizeChainId-e4cc0175.browser.esm.js ***!
  \***************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   n: function() { return /* binding */ normalizeChainId; }\n/* harmony export */ });\nfunction normalizeChainId(chainId) {\n  if (typeof chainId === \"string\") {\n    return Number.parseInt(chainId, chainId.trim().substring(0, 2) === \"0x\" ? 16 : 10);\n  }\n  if (typeof chainId === \"bigint\") {\n    return Number(chainId);\n  }\n  return chainId;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3JlYWN0L25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3dhbGxldHMvZGlzdC9ub3JtYWxpemVDaGFpbklkLWU0Y2MwMTc1LmJyb3dzZXIuZXNtLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWlDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3JlYWN0L25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3dhbGxldHMvZGlzdC9ub3JtYWxpemVDaGFpbklkLWU0Y2MwMTc1LmJyb3dzZXIuZXNtLmpzP2ExNzgiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbm9ybWFsaXplQ2hhaW5JZChjaGFpbklkKSB7XG4gIGlmICh0eXBlb2YgY2hhaW5JZCA9PT0gXCJzdHJpbmdcIikge1xuICAgIHJldHVybiBOdW1iZXIucGFyc2VJbnQoY2hhaW5JZCwgY2hhaW5JZC50cmltKCkuc3Vic3RyaW5nKDAsIDIpID09PSBcIjB4XCIgPyAxNiA6IDEwKTtcbiAgfVxuICBpZiAodHlwZW9mIGNoYWluSWQgPT09IFwiYmlnaW50XCIpIHtcbiAgICByZXR1cm4gTnVtYmVyKGNoYWluSWQpO1xuICB9XG4gIHJldHVybiBjaGFpbklkO1xufVxuXG5leHBvcnQgeyBub3JtYWxpemVDaGFpbklkIGFzIG4gfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/normalizeChainId-e4cc0175.browser.esm.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/evm/connectors/embedded-wallet/dist/thirdweb-dev-wallets-evm-connectors-embedded-wallet.browser.esm.js":
/*!************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/evm/connectors/embedded-wallet/dist/thirdweb-dev-wallets-evm-connectors-embedded-wallet.browser.esm.js ***!
  \************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EmbeddedWalletConnector: function() { return /* binding */ EmbeddedWalletConnector; }\n/* harmony export */ });\n/* harmony import */ var _dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../dist/classPrivateFieldSet-a5db7c83.browser.esm.js */ \"(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/classPrivateFieldSet-a5db7c83.browser.esm.js\");\n/* harmony import */ var _dist_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../dist/defineProperty-c8ecdc07.browser.esm.js */ \"(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/defineProperty-c8ecdc07.browser.esm.js\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ethers */ \"(app-pages-browser)/./node_modules/@ethersproject/address/lib.esm/index.js\");\n/* harmony import */ var _dist_walletIds_08486e13_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../dist/walletIds-08486e13.browser.esm.js */ \"(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/walletIds-08486e13.browser.esm.js\");\n/* harmony import */ var _dist_connector_05689d68_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../dist/connector-05689d68.browser.esm.js */ \"(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/connector-05689d68.browser.esm.js\");\n/* harmony import */ var _dist_normalizeChainId_e4cc0175_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../dist/normalizeChainId-e4cc0175.browser.esm.js */ \"(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/normalizeChainId-e4cc0175.browser.esm.js\");\n/* harmony import */ var _dist_embedded_wallet_30be9c09_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../dist/embedded-wallet-30be9c09.browser.esm.js */ \"(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/dist/embedded-wallet-30be9c09.browser.esm.js\");\n/* harmony import */ var eventemitter3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! eventemitter3 */ \"(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/eventemitter3/index.mjs\");\n\n\n\n\n\n\n\n\n\n\n\nvar _embeddedWalletSdk = /*#__PURE__*/new WeakMap();\nvar _signer = /*#__PURE__*/new WeakMap();\nclass EmbeddedWalletConnector extends _dist_connector_05689d68_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.C {\n  constructor(options) {\n    super();\n    (0,_dist_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"id\", _dist_walletIds_08486e13_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.w.paper);\n    (0,_dist_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"name\", \"Embedded Wallet\");\n    (0,_dist_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"ready\", true);\n    (0,_dist_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"user\", null);\n    (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__._)(this, _embeddedWalletSdk, {\n      writable: true,\n      value: void 0\n    });\n    (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__._)(this, _signer, {\n      writable: true,\n      value: void 0\n    });\n    (0,_dist_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onAccountsChanged\", async accounts => {\n      if (accounts.length === 0) {\n        await this.onDisconnect();\n      } else {\n        this.emit(\"change\", {\n          account: ethers__WEBPACK_IMPORTED_MODULE_5__.getAddress(accounts[0])\n        });\n      }\n    });\n    (0,_dist_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onChainChanged\", chainId => {\n      const id = (0,_dist_normalizeChainId_e4cc0175_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.n)(chainId);\n      const unsupported = this.options.chains.findIndex(c => c.chainId === id) === -1;\n      this.emit(\"change\", {\n        chain: {\n          id,\n          unsupported\n        }\n      });\n    });\n    (0,_dist_defineProperty_c8ecdc07_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__._)(this, \"onDisconnect\", async () => {\n      this.emit(\"disconnect\");\n    });\n    this.options = options;\n  }\n  getEmbeddedWalletSDK() {\n    if (!(0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.b)(this, _embeddedWalletSdk)) {\n      (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.a)(this, _embeddedWalletSdk, new _dist_embedded_wallet_30be9c09_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__.E({\n        clientId: this.options.clientId,\n        chain: \"Ethereum\",\n        onAuthSuccess: this.options.onAuthSuccess\n      }));\n    }\n    return (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.b)(this, _embeddedWalletSdk);\n  }\n  async connect(args) {\n    // backwards compatibility - options should really be required here\n    if (!args) {\n      // default to iframe flow\n      const result = await this.authenticate({\n        strategy: \"iframe\"\n      });\n      if (!result.user) {\n        throw new Error(\"Error connecting User\");\n      }\n      this.user = result.user;\n    } else {\n      if (!args.authResult) {\n        throw new Error(\"Missing authData - call authenticate() first with your authentication strategy\");\n      }\n      if (!args.authResult.user) {\n        throw new Error(\"Missing authData.user - call authenticate() first with your authentication strategy\");\n      }\n      this.user = args.authResult.user;\n    }\n    if (args?.chainId) {\n      this.switchChain(args.chainId);\n    }\n    return this.getAddress();\n  }\n  async disconnect() {\n    const paper = (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.b)(this, _embeddedWalletSdk);\n    await paper?.auth.logout();\n    (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.a)(this, _signer, undefined);\n    (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.a)(this, _embeddedWalletSdk, undefined);\n    this.user = null;\n  }\n  async getAddress() {\n    if (!this.user) {\n      throw new Error(\"Embedded Wallet is not connected\");\n    }\n    return await this.getSigner().then(signer => signer.getAddress());\n  }\n  async isConnected() {\n    try {\n      const addr = await this.getAddress();\n      return !!addr;\n    } catch (e) {\n      return false;\n    }\n  }\n  async getProvider() {\n    const signer = await this.getSigner();\n    if (!signer.provider) {\n      throw new Error(\"Provider not found\");\n    }\n    return signer.provider;\n  }\n  async getSigner() {\n    if ((0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.b)(this, _signer)) {\n      return (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.b)(this, _signer);\n    }\n    const user = await this.getUser();\n    const signer = await user.wallet.getEthersJsSigner({\n      rpcEndpoint: this.options.chain.rpc[0] || \"\" // TODO: handle chain.rpc being empty array\n    });\n\n    if (!signer) {\n      throw new Error(\"Signer not found\");\n    }\n    (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.a)(this, _signer, signer);\n    return signer;\n  }\n  async isAuthorized() {\n    return false;\n  }\n  async switchChain(chainId) {\n    const chain = this.options.chains.find(c => c.chainId === chainId);\n    if (!chain) {\n      throw new Error(\"Chain not configured\");\n    }\n    try {\n      // update chain in wallet\n      await this.user?.wallet.setChain({\n        chain: \"Ethereum\"\n      }); // just pass Ethereum no matter what chain we are going to connect\n      // update signer\n      (0,_dist_classPrivateFieldSet_a5db7c83_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.a)(this, _signer, await this.user?.wallet.getEthersJsSigner({\n        rpcEndpoint: chain.rpc[0] || \"\"\n      }));\n      this.emit(\"change\", {\n        chain: {\n          id: chainId,\n          unsupported: false\n        }\n      });\n    } catch (e) {\n      console.warn(\"Failed to switch chain\", e);\n    }\n  }\n  async setupListeners() {\n    return Promise.resolve();\n  }\n  updateChains(chains) {\n    this.options.chains = chains;\n  }\n  async getUser() {\n    if (!this.user || !this.user.wallet || !this.user.wallet.getEthersJsSigner // when serializing, functions are lost, need to rehydrate\n    ) {\n      const embeddedWalletSdk = this.getEmbeddedWalletSDK();\n      const user = await embeddedWalletSdk.getUser();\n      switch (user.status) {\n        case _dist_embedded_wallet_30be9c09_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__.U.LOGGED_IN_WALLET_INITIALIZED:\n          {\n            this.user = user;\n            break;\n          }\n        default:\n          {\n            // if logged out or unitialized, we can't get a signer, so throw an error\n            throw new Error(\"Embedded Wallet is not authenticated, please authenticate first\");\n          }\n      }\n    }\n    return this.user;\n  }\n  async getEmail() {\n    const user = await this.getUser();\n    return user.authDetails.email;\n  }\n  async getRecoveryInformation() {\n    const user = await this.getUser();\n    return user.authDetails;\n  }\n  async sendVerificationEmail(_ref) {\n    let {\n      email\n    } = _ref;\n    const ewSDK = this.getEmbeddedWalletSDK();\n    return ewSDK.auth.sendEmailLoginOtp({\n      email\n    });\n  }\n  async authenticate(params) {\n    const ewSDK = this.getEmbeddedWalletSDK();\n    const strategy = params.strategy;\n    switch (strategy) {\n      case \"email_verification\":\n        {\n          return await ewSDK.auth.verifyEmailLoginOtp({\n            email: params.email,\n            otp: params.verificationCode,\n            recoveryCode: params.recoveryCode\n          });\n        }\n      case \"apple\":\n      case \"facebook\":\n      case \"google\":\n        {\n          const oauthProvider = oauthStrategyToAuthProvider[strategy];\n          return ewSDK.auth.loginWithOauth({\n            oauthProvider,\n            closeOpenedWindow: params.closeOpenedWindow,\n            openedWindow: params.openedWindow\n          });\n        }\n      case \"jwt\":\n        {\n          return ewSDK.auth.loginWithCustomJwt({\n            jwt: params.jwt,\n            encryptionKey: params.encryptionKey\n          });\n        }\n      case \"iframe_email_verification\":\n        {\n          return ewSDK.auth.loginWithEmailOtp({\n            email: params.email\n          });\n        }\n      case \"iframe\":\n      case undefined:\n        {\n          return ewSDK.auth.loginWithModal();\n        }\n      default:\n        assertUnreachable(strategy);\n    }\n  }\n}\nfunction assertUnreachable(x) {\n  throw new Error(\"Invalid param: \" + x);\n}\nconst oauthStrategyToAuthProvider = {\n  google: _dist_embedded_wallet_30be9c09_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__.c.GOOGLE,\n  facebook: _dist_embedded_wallet_30be9c09_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__.c.FACEBOOK,\n  apple: _dist_embedded_wallet_30be9c09_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__.c.APPLE\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3JlYWN0L25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3dhbGxldHMvZXZtL2Nvbm5lY3RvcnMvZW1iZWRkZWQtd2FsbGV0L2Rpc3QvdGhpcmR3ZWItZGV2LXdhbGxldHMtZXZtLWNvbm5lY3RvcnMtZW1iZWRkZWQtd2FsbGV0LmJyb3dzZXIuZXNtLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF3SztBQUN6RTtBQUNoRTtBQUNxRDtBQUNBO0FBQ2M7QUFDMEM7QUFDckg7QUFDaUI7QUFDZDs7QUFFMUI7QUFDQTtBQUNBLHNDQUFzQyxzRUFBUztBQUMvQztBQUNBO0FBQ0EsSUFBSSwrRUFBZSxhQUFhLHNFQUFTO0FBQ3pDLElBQUksK0VBQWU7QUFDbkIsSUFBSSwrRUFBZTtBQUNuQixJQUFJLCtFQUFlO0FBQ25CLElBQUkscUZBQTBCO0FBQzlCO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsSUFBSSxxRkFBMEI7QUFDOUI7QUFDQTtBQUNBLEtBQUs7QUFDTCxJQUFJLCtFQUFlO0FBQ25CO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxtQkFBbUIsOENBQWdCO0FBQ25DLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTCxJQUFJLCtFQUFlO0FBQ25CLGlCQUFpQixpRkFBZ0I7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxJQUFJLCtFQUFlO0FBQ25CO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVMscUZBQXFCO0FBQzlCLE1BQU0scUZBQXFCLCtCQUErQiw0RUFBaUI7QUFDM0U7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsV0FBVyxxRkFBcUI7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixxRkFBcUI7QUFDdkM7QUFDQSxJQUFJLHFGQUFxQjtBQUN6QixJQUFJLHFGQUFxQjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEscUZBQXFCO0FBQzdCLGFBQWEscUZBQXFCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxJQUFJLHFGQUFxQjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTyxHQUFHO0FBQ1Y7QUFDQSxNQUFNLHFGQUFxQjtBQUMzQjtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDRFQUFnQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSw0RUFBWTtBQUN0QixZQUFZLDRFQUFZO0FBQ3hCLFNBQVMsNEVBQVk7QUFDckI7O0FBRW1DIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3JlYWN0L25vZGVfbW9kdWxlcy9AdGhpcmR3ZWItZGV2L3dhbGxldHMvZXZtL2Nvbm5lY3RvcnMvZW1iZWRkZWQtd2FsbGV0L2Rpc3QvdGhpcmR3ZWItZGV2LXdhbGxldHMtZXZtLWNvbm5lY3RvcnMtZW1iZWRkZWQtd2FsbGV0LmJyb3dzZXIuZXNtLmpzPzUwMTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgXyBhcyBfY2xhc3NQcml2YXRlRmllbGRJbml0U3BlYywgYiBhcyBfY2xhc3NQcml2YXRlRmllbGRHZXQsIGEgYXMgX2NsYXNzUHJpdmF0ZUZpZWxkU2V0IH0gZnJvbSAnLi4vLi4vLi4vLi4vZGlzdC9jbGFzc1ByaXZhdGVGaWVsZFNldC1hNWRiN2M4My5icm93c2VyLmVzbS5qcyc7XG5pbXBvcnQgeyBfIGFzIF9kZWZpbmVQcm9wZXJ0eSB9IGZyb20gJy4uLy4uLy4uLy4uL2Rpc3QvZGVmaW5lUHJvcGVydHktYzhlY2RjMDcuYnJvd3Nlci5lc20uanMnO1xuaW1wb3J0IHsgdXRpbHMgfSBmcm9tICdldGhlcnMnO1xuaW1wb3J0IHsgdyBhcyB3YWxsZXRJZHMgfSBmcm9tICcuLi8uLi8uLi8uLi9kaXN0L3dhbGxldElkcy0wODQ4NmUxMy5icm93c2VyLmVzbS5qcyc7XG5pbXBvcnQgeyBDIGFzIENvbm5lY3RvciB9IGZyb20gJy4uLy4uLy4uLy4uL2Rpc3QvY29ubmVjdG9yLTA1Njg5ZDY4LmJyb3dzZXIuZXNtLmpzJztcbmltcG9ydCB7IG4gYXMgbm9ybWFsaXplQ2hhaW5JZCB9IGZyb20gJy4uLy4uLy4uLy4uL2Rpc3Qvbm9ybWFsaXplQ2hhaW5JZC1lNGNjMDE3NS5icm93c2VyLmVzbS5qcyc7XG5pbXBvcnQgeyBFIGFzIEVtYmVkZGVkV2FsbGV0U2RrLCBVIGFzIFVzZXJXYWxsZXRTdGF0dXMsIGMgYXMgQXV0aFByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vLi4vLi4vZGlzdC9lbWJlZGRlZC13YWxsZXQtMzBiZTljMDkuYnJvd3Nlci5lc20uanMnO1xuaW1wb3J0ICdldmVudGVtaXR0ZXIzJztcbmltcG9ydCAnQHBhcGVyeHl6L3Nkay1jb21tb24tdXRpbGl0aWVzJztcbmltcG9ydCAnZXRoZXJzL2xpYi91dGlscyc7XG5cbnZhciBfZW1iZWRkZWRXYWxsZXRTZGsgPSAvKiNfX1BVUkVfXyovbmV3IFdlYWtNYXAoKTtcbnZhciBfc2lnbmVyID0gLyojX19QVVJFX18qL25ldyBXZWFrTWFwKCk7XG5jbGFzcyBFbWJlZGRlZFdhbGxldENvbm5lY3RvciBleHRlbmRzIENvbm5lY3RvciB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICBzdXBlcigpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImlkXCIsIHdhbGxldElkcy5wYXBlcik7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwibmFtZVwiLCBcIkVtYmVkZGVkIFdhbGxldFwiKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJyZWFkeVwiLCB0cnVlKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJ1c2VyXCIsIG51bGwpO1xuICAgIF9jbGFzc1ByaXZhdGVGaWVsZEluaXRTcGVjKHRoaXMsIF9lbWJlZGRlZFdhbGxldFNkaywge1xuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogdm9pZCAwXG4gICAgfSk7XG4gICAgX2NsYXNzUHJpdmF0ZUZpZWxkSW5pdFNwZWModGhpcywgX3NpZ25lciwge1xuICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICB2YWx1ZTogdm9pZCAwXG4gICAgfSk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwib25BY2NvdW50c0NoYW5nZWRcIiwgYXN5bmMgYWNjb3VudHMgPT4ge1xuICAgICAgaWYgKGFjY291bnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBhd2FpdCB0aGlzLm9uRGlzY29ubmVjdCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5lbWl0KFwiY2hhbmdlXCIsIHtcbiAgICAgICAgICBhY2NvdW50OiB1dGlscy5nZXRBZGRyZXNzKGFjY291bnRzWzBdKVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJvbkNoYWluQ2hhbmdlZFwiLCBjaGFpbklkID0+IHtcbiAgICAgIGNvbnN0IGlkID0gbm9ybWFsaXplQ2hhaW5JZChjaGFpbklkKTtcbiAgICAgIGNvbnN0IHVuc3VwcG9ydGVkID0gdGhpcy5vcHRpb25zLmNoYWlucy5maW5kSW5kZXgoYyA9PiBjLmNoYWluSWQgPT09IGlkKSA9PT0gLTE7XG4gICAgICB0aGlzLmVtaXQoXCJjaGFuZ2VcIiwge1xuICAgICAgICBjaGFpbjoge1xuICAgICAgICAgIGlkLFxuICAgICAgICAgIHVuc3VwcG9ydGVkXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIm9uRGlzY29ubmVjdFwiLCBhc3luYyAoKSA9PiB7XG4gICAgICB0aGlzLmVtaXQoXCJkaXNjb25uZWN0XCIpO1xuICAgIH0pO1xuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gIH1cbiAgZ2V0RW1iZWRkZWRXYWxsZXRTREsoKSB7XG4gICAgaWYgKCFfY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX2VtYmVkZGVkV2FsbGV0U2RrKSkge1xuICAgICAgX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9lbWJlZGRlZFdhbGxldFNkaywgbmV3IEVtYmVkZGVkV2FsbGV0U2RrKHtcbiAgICAgICAgY2xpZW50SWQ6IHRoaXMub3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgY2hhaW46IFwiRXRoZXJldW1cIixcbiAgICAgICAgb25BdXRoU3VjY2VzczogdGhpcy5vcHRpb25zLm9uQXV0aFN1Y2Nlc3NcbiAgICAgIH0pKTtcbiAgICB9XG4gICAgcmV0dXJuIF9jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfZW1iZWRkZWRXYWxsZXRTZGspO1xuICB9XG4gIGFzeW5jIGNvbm5lY3QoYXJncykge1xuICAgIC8vIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IC0gb3B0aW9ucyBzaG91bGQgcmVhbGx5IGJlIHJlcXVpcmVkIGhlcmVcbiAgICBpZiAoIWFyZ3MpIHtcbiAgICAgIC8vIGRlZmF1bHQgdG8gaWZyYW1lIGZsb3dcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXV0aGVudGljYXRlKHtcbiAgICAgICAgc3RyYXRlZ3k6IFwiaWZyYW1lXCJcbiAgICAgIH0pO1xuICAgICAgaWYgKCFyZXN1bHQudXNlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFcnJvciBjb25uZWN0aW5nIFVzZXJcIik7XG4gICAgICB9XG4gICAgICB0aGlzLnVzZXIgPSByZXN1bHQudXNlcjtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCFhcmdzLmF1dGhSZXN1bHQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBhdXRoRGF0YSAtIGNhbGwgYXV0aGVudGljYXRlKCkgZmlyc3Qgd2l0aCB5b3VyIGF1dGhlbnRpY2F0aW9uIHN0cmF0ZWd5XCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFhcmdzLmF1dGhSZXN1bHQudXNlcikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIGF1dGhEYXRhLnVzZXIgLSBjYWxsIGF1dGhlbnRpY2F0ZSgpIGZpcnN0IHdpdGggeW91ciBhdXRoZW50aWNhdGlvbiBzdHJhdGVneVwiKTtcbiAgICAgIH1cbiAgICAgIHRoaXMudXNlciA9IGFyZ3MuYXV0aFJlc3VsdC51c2VyO1xuICAgIH1cbiAgICBpZiAoYXJncz8uY2hhaW5JZCkge1xuICAgICAgdGhpcy5zd2l0Y2hDaGFpbihhcmdzLmNoYWluSWQpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5nZXRBZGRyZXNzKCk7XG4gIH1cbiAgYXN5bmMgZGlzY29ubmVjdCgpIHtcbiAgICBjb25zdCBwYXBlciA9IF9jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfZW1iZWRkZWRXYWxsZXRTZGspO1xuICAgIGF3YWl0IHBhcGVyPy5hdXRoLmxvZ291dCgpO1xuICAgIF9jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfc2lnbmVyLCB1bmRlZmluZWQpO1xuICAgIF9jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfZW1iZWRkZWRXYWxsZXRTZGssIHVuZGVmaW5lZCk7XG4gICAgdGhpcy51c2VyID0gbnVsbDtcbiAgfVxuICBhc3luYyBnZXRBZGRyZXNzKCkge1xuICAgIGlmICghdGhpcy51c2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFbWJlZGRlZCBXYWxsZXQgaXMgbm90IGNvbm5lY3RlZFwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0U2lnbmVyKCkudGhlbihzaWduZXIgPT4gc2lnbmVyLmdldEFkZHJlc3MoKSk7XG4gIH1cbiAgYXN5bmMgaXNDb25uZWN0ZWQoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGFkZHIgPSBhd2FpdCB0aGlzLmdldEFkZHJlc3MoKTtcbiAgICAgIHJldHVybiAhIWFkZHI7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBhc3luYyBnZXRQcm92aWRlcigpIHtcbiAgICBjb25zdCBzaWduZXIgPSBhd2FpdCB0aGlzLmdldFNpZ25lcigpO1xuICAgIGlmICghc2lnbmVyLnByb3ZpZGVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm92aWRlciBub3QgZm91bmRcIik7XG4gICAgfVxuICAgIHJldHVybiBzaWduZXIucHJvdmlkZXI7XG4gIH1cbiAgYXN5bmMgZ2V0U2lnbmVyKCkge1xuICAgIGlmIChfY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX3NpZ25lcikpIHtcbiAgICAgIHJldHVybiBfY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX3NpZ25lcik7XG4gICAgfVxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB0aGlzLmdldFVzZXIoKTtcbiAgICBjb25zdCBzaWduZXIgPSBhd2FpdCB1c2VyLndhbGxldC5nZXRFdGhlcnNKc1NpZ25lcih7XG4gICAgICBycGNFbmRwb2ludDogdGhpcy5vcHRpb25zLmNoYWluLnJwY1swXSB8fCBcIlwiIC8vIFRPRE86IGhhbmRsZSBjaGFpbi5ycGMgYmVpbmcgZW1wdHkgYXJyYXlcbiAgICB9KTtcblxuICAgIGlmICghc2lnbmVyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTaWduZXIgbm90IGZvdW5kXCIpO1xuICAgIH1cbiAgICBfY2xhc3NQcml2YXRlRmllbGRTZXQodGhpcywgX3NpZ25lciwgc2lnbmVyKTtcbiAgICByZXR1cm4gc2lnbmVyO1xuICB9XG4gIGFzeW5jIGlzQXV0aG9yaXplZCgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgYXN5bmMgc3dpdGNoQ2hhaW4oY2hhaW5JZCkge1xuICAgIGNvbnN0IGNoYWluID0gdGhpcy5vcHRpb25zLmNoYWlucy5maW5kKGMgPT4gYy5jaGFpbklkID09PSBjaGFpbklkKTtcbiAgICBpZiAoIWNoYWluKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDaGFpbiBub3QgY29uZmlndXJlZFwiKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIC8vIHVwZGF0ZSBjaGFpbiBpbiB3YWxsZXRcbiAgICAgIGF3YWl0IHRoaXMudXNlcj8ud2FsbGV0LnNldENoYWluKHtcbiAgICAgICAgY2hhaW46IFwiRXRoZXJldW1cIlxuICAgICAgfSk7IC8vIGp1c3QgcGFzcyBFdGhlcmV1bSBubyBtYXR0ZXIgd2hhdCBjaGFpbiB3ZSBhcmUgZ29pbmcgdG8gY29ubmVjdFxuICAgICAgLy8gdXBkYXRlIHNpZ25lclxuICAgICAgX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9zaWduZXIsIGF3YWl0IHRoaXMudXNlcj8ud2FsbGV0LmdldEV0aGVyc0pzU2lnbmVyKHtcbiAgICAgICAgcnBjRW5kcG9pbnQ6IGNoYWluLnJwY1swXSB8fCBcIlwiXG4gICAgICB9KSk7XG4gICAgICB0aGlzLmVtaXQoXCJjaGFuZ2VcIiwge1xuICAgICAgICBjaGFpbjoge1xuICAgICAgICAgIGlkOiBjaGFpbklkLFxuICAgICAgICAgIHVuc3VwcG9ydGVkOiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJGYWlsZWQgdG8gc3dpdGNoIGNoYWluXCIsIGUpO1xuICAgIH1cbiAgfVxuICBhc3luYyBzZXR1cExpc3RlbmVycygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH1cbiAgdXBkYXRlQ2hhaW5zKGNoYWlucykge1xuICAgIHRoaXMub3B0aW9ucy5jaGFpbnMgPSBjaGFpbnM7XG4gIH1cbiAgYXN5bmMgZ2V0VXNlcigpIHtcbiAgICBpZiAoIXRoaXMudXNlciB8fCAhdGhpcy51c2VyLndhbGxldCB8fCAhdGhpcy51c2VyLndhbGxldC5nZXRFdGhlcnNKc1NpZ25lciAvLyB3aGVuIHNlcmlhbGl6aW5nLCBmdW5jdGlvbnMgYXJlIGxvc3QsIG5lZWQgdG8gcmVoeWRyYXRlXG4gICAgKSB7XG4gICAgICBjb25zdCBlbWJlZGRlZFdhbGxldFNkayA9IHRoaXMuZ2V0RW1iZWRkZWRXYWxsZXRTREsoKTtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBlbWJlZGRlZFdhbGxldFNkay5nZXRVc2VyKCk7XG4gICAgICBzd2l0Y2ggKHVzZXIuc3RhdHVzKSB7XG4gICAgICAgIGNhc2UgVXNlcldhbGxldFN0YXR1cy5MT0dHRURfSU5fV0FMTEVUX0lOSVRJQUxJWkVEOlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMudXNlciA9IHVzZXI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAge1xuICAgICAgICAgICAgLy8gaWYgbG9nZ2VkIG91dCBvciB1bml0aWFsaXplZCwgd2UgY2FuJ3QgZ2V0IGEgc2lnbmVyLCBzbyB0aHJvdyBhbiBlcnJvclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW1iZWRkZWQgV2FsbGV0IGlzIG5vdCBhdXRoZW50aWNhdGVkLCBwbGVhc2UgYXV0aGVudGljYXRlIGZpcnN0XCIpO1xuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudXNlcjtcbiAgfVxuICBhc3luYyBnZXRFbWFpbCgpIHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5nZXRVc2VyKCk7XG4gICAgcmV0dXJuIHVzZXIuYXV0aERldGFpbHMuZW1haWw7XG4gIH1cbiAgYXN5bmMgZ2V0UmVjb3ZlcnlJbmZvcm1hdGlvbigpIHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5nZXRVc2VyKCk7XG4gICAgcmV0dXJuIHVzZXIuYXV0aERldGFpbHM7XG4gIH1cbiAgYXN5bmMgc2VuZFZlcmlmaWNhdGlvbkVtYWlsKF9yZWYpIHtcbiAgICBsZXQge1xuICAgICAgZW1haWxcbiAgICB9ID0gX3JlZjtcbiAgICBjb25zdCBld1NESyA9IHRoaXMuZ2V0RW1iZWRkZWRXYWxsZXRTREsoKTtcbiAgICByZXR1cm4gZXdTREsuYXV0aC5zZW5kRW1haWxMb2dpbk90cCh7XG4gICAgICBlbWFpbFxuICAgIH0pO1xuICB9XG4gIGFzeW5jIGF1dGhlbnRpY2F0ZShwYXJhbXMpIHtcbiAgICBjb25zdCBld1NESyA9IHRoaXMuZ2V0RW1iZWRkZWRXYWxsZXRTREsoKTtcbiAgICBjb25zdCBzdHJhdGVneSA9IHBhcmFtcy5zdHJhdGVneTtcbiAgICBzd2l0Y2ggKHN0cmF0ZWd5KSB7XG4gICAgICBjYXNlIFwiZW1haWxfdmVyaWZpY2F0aW9uXCI6XG4gICAgICAgIHtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgZXdTREsuYXV0aC52ZXJpZnlFbWFpbExvZ2luT3RwKHtcbiAgICAgICAgICAgIGVtYWlsOiBwYXJhbXMuZW1haWwsXG4gICAgICAgICAgICBvdHA6IHBhcmFtcy52ZXJpZmljYXRpb25Db2RlLFxuICAgICAgICAgICAgcmVjb3ZlcnlDb2RlOiBwYXJhbXMucmVjb3ZlcnlDb2RlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIGNhc2UgXCJhcHBsZVwiOlxuICAgICAgY2FzZSBcImZhY2Vib29rXCI6XG4gICAgICBjYXNlIFwiZ29vZ2xlXCI6XG4gICAgICAgIHtcbiAgICAgICAgICBjb25zdCBvYXV0aFByb3ZpZGVyID0gb2F1dGhTdHJhdGVneVRvQXV0aFByb3ZpZGVyW3N0cmF0ZWd5XTtcbiAgICAgICAgICByZXR1cm4gZXdTREsuYXV0aC5sb2dpbldpdGhPYXV0aCh7XG4gICAgICAgICAgICBvYXV0aFByb3ZpZGVyLFxuICAgICAgICAgICAgY2xvc2VPcGVuZWRXaW5kb3c6IHBhcmFtcy5jbG9zZU9wZW5lZFdpbmRvdyxcbiAgICAgICAgICAgIG9wZW5lZFdpbmRvdzogcGFyYW1zLm9wZW5lZFdpbmRvd1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICBjYXNlIFwiand0XCI6XG4gICAgICAgIHtcbiAgICAgICAgICByZXR1cm4gZXdTREsuYXV0aC5sb2dpbldpdGhDdXN0b21Kd3Qoe1xuICAgICAgICAgICAgand0OiBwYXJhbXMuand0LFxuICAgICAgICAgICAgZW5jcnlwdGlvbktleTogcGFyYW1zLmVuY3J5cHRpb25LZXlcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgY2FzZSBcImlmcmFtZV9lbWFpbF92ZXJpZmljYXRpb25cIjpcbiAgICAgICAge1xuICAgICAgICAgIHJldHVybiBld1NESy5hdXRoLmxvZ2luV2l0aEVtYWlsT3RwKHtcbiAgICAgICAgICAgIGVtYWlsOiBwYXJhbXMuZW1haWxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgY2FzZSBcImlmcmFtZVwiOlxuICAgICAgY2FzZSB1bmRlZmluZWQ6XG4gICAgICAgIHtcbiAgICAgICAgICByZXR1cm4gZXdTREsuYXV0aC5sb2dpbldpdGhNb2RhbCgpO1xuICAgICAgICB9XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBhc3NlcnRVbnJlYWNoYWJsZShzdHJhdGVneSk7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBhc3NlcnRVbnJlYWNoYWJsZSh4KSB7XG4gIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGFyYW06IFwiICsgeCk7XG59XG5jb25zdCBvYXV0aFN0cmF0ZWd5VG9BdXRoUHJvdmlkZXIgPSB7XG4gIGdvb2dsZTogQXV0aFByb3ZpZGVyLkdPT0dMRSxcbiAgZmFjZWJvb2s6IEF1dGhQcm92aWRlci5GQUNFQk9PSyxcbiAgYXBwbGU6IEF1dGhQcm92aWRlci5BUFBMRVxufTtcblxuZXhwb3J0IHsgRW1iZWRkZWRXYWxsZXRDb25uZWN0b3IgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@thirdweb-dev/react/node_modules/@thirdweb-dev/wallets/evm/connectors/embedded-wallet/dist/thirdweb-dev-wallets-evm-connectors-embedded-wallet.browser.esm.js\n"));

/***/ }),

/***/ "(app-pages-browser)/./node_modules/@paperxyz/sdk-common-utilities/dist/index.mjs":
/*!********************************************************************!*\
  !*** ./node_modules/@paperxyz/sdk-common-utilities/dist/index.mjs ***!
  \********************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChainToPublicRpc: function() { return /* binding */ e; },\n/* harmony export */   DEFAULT_BRAND_OPTIONS: function() { return /* binding */ n; },\n/* harmony export */   getPaperOriginUrl: function() { return /* binding */ i; }\n/* harmony export */ });\nvar e={Ethereum:\"https://ethereum.rpc.thirdweb.com\",Goerli:\"https://goerli.rpc.thirdweb.com\",Mumbai:\"https://mumbai.rpc.thirdweb.com\",Polygon:\"https://polygon.rpc.thirdweb.com\",Avalanche:\"https://avalanche.rpc.thirdweb.com\",Optimism:\"https://optimism.rpc.thirdweb.com\",OptimismGoerli:\"https://optimism-goerli.rpc.thirdweb.com\",BSC:\"https://binance.rpc.thirdweb.com\",BSCTestnet:\"https://binance-testnet.rpc.thirdweb.com\",ArbitrumOne:\"https://arbitrum.rpc.thirdweb.com\",ArbitrumGoerli:\"https://arbitrum-goerli.rpc.thirdweb.com\",Fantom:\"https://fantom.rpc.thirdweb.com\",FantomTestnet:\"https://fantom-testnet.rpc.thirdweb.com\",Sepolia:\"https://sepolia.rpc.thirdweb.com\",AvalancheFuji:\"https://avalanche-fuji.rpc.thirdweb.com\"};var o=()=>typeof window!=\"undefined\"&&window.localStorage.getItem(\"IS_PAPER_DEV\")===\"true\",r=()=>typeof window!=\"undefined\"&&window.location.origin.includes(\"paper.xyz\"),i=()=>{var t;return o()?(t=window.localStorage.getItem(\"PAPER_DEV_URL\"))!=null?t:\"http://localhost:3000\":r()?window.location.origin:\"https://withpaper.com\"};var n={colorPrimary:\"#cf3781\",colorBackground:\"#ffffff\",colorText:\"#1a202c\",borderRadius:12,fontFamily:\"Open Sans\"};\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9AcGFwZXJ4eXovc2RrLWNvbW1vbi11dGlsaXRpZXMvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsT0FBTyw0c0JBQTRzQixpTEFBaUwsTUFBTSxnSkFBZ0osT0FBTyw2R0FBNkw7QUFDOXRDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL25vZGVfbW9kdWxlcy9AcGFwZXJ4eXovc2RrLWNvbW1vbi11dGlsaXRpZXMvZGlzdC9pbmRleC5tanM/ZGRmYiJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZT17RXRoZXJldW06XCJodHRwczovL2V0aGVyZXVtLnJwYy50aGlyZHdlYi5jb21cIixHb2VybGk6XCJodHRwczovL2dvZXJsaS5ycGMudGhpcmR3ZWIuY29tXCIsTXVtYmFpOlwiaHR0cHM6Ly9tdW1iYWkucnBjLnRoaXJkd2ViLmNvbVwiLFBvbHlnb246XCJodHRwczovL3BvbHlnb24ucnBjLnRoaXJkd2ViLmNvbVwiLEF2YWxhbmNoZTpcImh0dHBzOi8vYXZhbGFuY2hlLnJwYy50aGlyZHdlYi5jb21cIixPcHRpbWlzbTpcImh0dHBzOi8vb3B0aW1pc20ucnBjLnRoaXJkd2ViLmNvbVwiLE9wdGltaXNtR29lcmxpOlwiaHR0cHM6Ly9vcHRpbWlzbS1nb2VybGkucnBjLnRoaXJkd2ViLmNvbVwiLEJTQzpcImh0dHBzOi8vYmluYW5jZS5ycGMudGhpcmR3ZWIuY29tXCIsQlNDVGVzdG5ldDpcImh0dHBzOi8vYmluYW5jZS10ZXN0bmV0LnJwYy50aGlyZHdlYi5jb21cIixBcmJpdHJ1bU9uZTpcImh0dHBzOi8vYXJiaXRydW0ucnBjLnRoaXJkd2ViLmNvbVwiLEFyYml0cnVtR29lcmxpOlwiaHR0cHM6Ly9hcmJpdHJ1bS1nb2VybGkucnBjLnRoaXJkd2ViLmNvbVwiLEZhbnRvbTpcImh0dHBzOi8vZmFudG9tLnJwYy50aGlyZHdlYi5jb21cIixGYW50b21UZXN0bmV0OlwiaHR0cHM6Ly9mYW50b20tdGVzdG5ldC5ycGMudGhpcmR3ZWIuY29tXCIsU2Vwb2xpYTpcImh0dHBzOi8vc2Vwb2xpYS5ycGMudGhpcmR3ZWIuY29tXCIsQXZhbGFuY2hlRnVqaTpcImh0dHBzOi8vYXZhbGFuY2hlLWZ1amkucnBjLnRoaXJkd2ViLmNvbVwifTt2YXIgbz0oKT0+dHlwZW9mIHdpbmRvdyE9XCJ1bmRlZmluZWRcIiYmd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiSVNfUEFQRVJfREVWXCIpPT09XCJ0cnVlXCIscj0oKT0+dHlwZW9mIHdpbmRvdyE9XCJ1bmRlZmluZWRcIiYmd2luZG93LmxvY2F0aW9uLm9yaWdpbi5pbmNsdWRlcyhcInBhcGVyLnh5elwiKSxpPSgpPT57dmFyIHQ7cmV0dXJuIG8oKT8odD13aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJQQVBFUl9ERVZfVVJMXCIpKSE9bnVsbD90OlwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCI6cigpP3dpbmRvdy5sb2NhdGlvbi5vcmlnaW46XCJodHRwczovL3dpdGhwYXBlci5jb21cIn07dmFyIG49e2NvbG9yUHJpbWFyeTpcIiNjZjM3ODFcIixjb2xvckJhY2tncm91bmQ6XCIjZmZmZmZmXCIsY29sb3JUZXh0OlwiIzFhMjAyY1wiLGJvcmRlclJhZGl1czoxMixmb250RmFtaWx5OlwiT3BlbiBTYW5zXCJ9O2V4cG9ydHtlIGFzIENoYWluVG9QdWJsaWNScGMsbiBhcyBERUZBVUxUX0JSQU5EX09QVElPTlMsaSBhcyBnZXRQYXBlck9yaWdpblVybH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./node_modules/@paperxyz/sdk-common-utilities/dist/index.mjs\n"));

/***/ })

}]);